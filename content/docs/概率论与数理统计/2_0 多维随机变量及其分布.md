---
title: 2_0 多维随机变量及其分布
date: 2025-07-23T16:07:04+08:00
math: true
---

> 内容来源于教材第三章，作为讲义的补充
## 学习目标

- 了解为什么要引入二维随机变量, 理解二维随机变量和联合分布的定义
- 理解一维随机变量和二维随机变量的差异, 掌握边缘分布和联合分布之间, 以及边缘密度函数和联合密度函数之间的联系
- 理解条件密度函数的定义, 掌握条件密度函数、边缘密度函数和联合密度函数三者之间的关系
- 掌握随机变量相互独立的定义, 并能熟练地应用独立性来求有关事件的概率
- 掌握求多个随机变量函数的分布的方法

## 多维随机变量及其分布

### 多维随机变量

有时候, 我们对随机试验的结果要用两个或两个以上的随机变量来描述, 例如为了研究某学区学龄前儿童的身体发育情况, 需要了解他 (她) 们的身高 $(H)$ 和体重 $(W)$ .记 $\Omega = \{\text{该学区学龄前儿童的全体}\}$, 学龄前儿童记为 $\omega$ ,则 $\{\omega :X(\omega) = (H(\omega),W(\omega))\}$ 表示该儿童的身高体重. $X$ 称为二维随机变量, 它可以用来描述学龄前儿童的身体发育状况.

> [!note] 定义 3.1 多维随机变量
> 设 $X_{1}(\omega),X_{2}(\omega),\dots ,X_{n}(\omega)$ 为**同一样本空间**上的随机变量, 则称
> $$
> X(\omega) = (X_{1}(\omega),X_{2}(\omega),\dots ,X_{n}(\omega))
> $$
为 $n$ 维随机变量, 或称为 $n$ 维随机向量. 通常简记为 $(X_{1},X_{2},\dots ,X_{n})$ 或 $X$

在多维随机变量中, 每个坐标都是同一样本空间中的随机变量 (图 3.1), 它们之间还会有某种关系, 所以研究单个随机变量是不够的. 我们必须把它们放在一起进行研究.

![|400](https://image.huarenjian.cn/image/20250723114354404.png)

先研究二维随机变量. 类似于一维随机变量, 我们也是要研究它们取哪些值以及取这些值的概率多大. 这就引入如下定义:

> [!note] 定义 3.2 二维分布函数
> 设 $(X,Y)$ 是二维随机变量, $(x,y)\in \mathbb{R}^{2}$ ,称二元函数
> $$
> \begin{aligned}F(x,y)&=P(X\leqslant x,Y\leqslant y)=P(\{\omega:X(\omega)\leqslant x,Y(\omega)\leqslant y\})\\&=P(\{X\leqslant x\}\cap\{Y\leqslant y\})\end{aligned}
> $$
> 为 $(X,Y)$ 的分布函数, 或 $(X,Y)$ 的联合分布函数 (joint cdf).

由二维联合分布函数 $F(x,y)$ ,我们可以求出二维随机向量 $(X,Y)$ 落在矩形区域 $(x_{1},x_{2}]\times (y_{1},y_{2}]$ 中的概率

![|300](https://image.huarenjian.cn/image/20250723162852784.png)

$$
P(x_1 < X \leq x_2,\ y_1 < Y \leq y_2) = F(x_2, y_2) - F(x_1, y_2) - F(x_2, y_1) + F(x_1, y_1)
$$
> [!note] 性质 - 二维联合分布函数
>
> 二维随机变量的联合分布函数 $F(x,y)$ 具有如下性质:
>
> (1) $F(x,y)$ 分别对 $x,y$ 单调不减的:
>
> (2) $\forall (x,y)\in \mathbb{R}^{2}$
> $$0\leqslant F(x,y)\leqslant1,\quad F(\infty,\infty)=1,\quad F(-\infty,y)=F(x,-\infty)=F(-\infty,-\infty)=0;$$
> (3) $F(x,y)$ 分别关于 $x,y$ 右连续;
>
> (4) $\forall x_{1}< x_{2},y_{1}< y_{2},P(x_{1}< X< x_{2},y_{1}< Y< y_{2})$ 非负, 即
> $$P(x_{1}< X< x_{2},y_{1}< Y< y_{2}) = F(x_{2},y_{2}) - F(x_{1},y_{2}) - F(x_{2},y_{1}) + F(x_{1},y_{1})\geqslant 0.$$

这 4 条性质的证明容易, 它们刻画了一个二维联合分布函数, 即一个二元实函数 $F(x, y)$ 如果满足上述 4 条性质, 那么必存在随机变量 $X$ 和 $Y$ , 使得 $F(x, y)$ 为它们的联合分布函数. 值得注意的是, 二维随机变量与一维随机变量不同, 刻画一个联合分布函数需要加上 (4). 也就是说从条件 (1)~(3) 推不出 (4).

例 3.1 定义二元函数

$$
\left.F(x,y)=\begin{cases}&0,&x\leqslant0\ \text{或}x+y\leqslant1\text{ 或}y\leqslant0,\\&1,&\text{其他}.\end{cases}\right.
$$

则 $F(x, y)$ 满足上述性质中的 (1)~(3), 但不满足 (4), 因而不是一个分布函数.

证 性质 (1)~(3) 容易验证. 对 (4), 因为

$$
F(1,1) - F\left(1, \frac{1}{3}\right) - F\left(\frac{1}{3}, 1\right) + F\left(\frac{1}{3}, \frac{1}{3}\right) = 1 - 1 - 1 - 0 = -1 < 0,
$$

从而得证. 事实上, 我们容易找到无穷多个不满足性质 (4) 的矩形.

当然, 对于二维离散型随机变量, 即每个分量都是离散型的随机变量, 我们不必用联合分布函数来描述其概率分布情况, 而可以指出它们在每个可能的取值点上的概率值即可.

> [!note] 定义 3.3 二维离散型随机变量
> 设 $X, Y$ 的可能取值为 $\{(x_i, y_j), i = 1, 2, \dots , j = 1, 2, \dots \}$ . 记
> $$P(X = x_i, Y = y_j) = p_{ij}, \quad i, j = 1, 2, \dots,$$
> 称其为二维离散型随机变量的联合概率质量函数或联合分布律 (joint pmf).

容易验证

(1) $p_{ij} \geqslant 0, i, j = 1, 2, \dots$ ;

(2) $\sum_{i, j} p_{ij} = 1$ .

当 $X, Y$ 都取有限个值时, 也常用下面的列表表示它们的联合分布律:

| $X$ $\backslash$ $Y$ | $y_1$    | $y_2$    | $\cdots$ | $y_n$    |
| -------------------- | -------- | -------- | -------- | -------- |
| $x_1$                | $p_{11}$ | $p_{12}$ | $\cdots$ | $p_{1n}$ |
| $x_2$                | $p_{21}$ | $p_{22}$ | $\cdots$ | $p_{2n}$ |
| $\vdots$             | $\vdots$ | $\vdots$ |          | $\vdots$ |
| $x_m$                | $p_{m1}$ | $p_{m2}$ | $\cdots$ | $p_{mn}$ |

一般地, 对 $n$ 维离散型随机变量, 我们有下述定义:

> [!note] 定义 3.4 $n$ 维离散型随机变量
> 称 $X = (X_{1},X_{2},\ldots ,X_{n})$ 为 $n$ 维离散型随机变量, 若每一个 $X_{i}$ 都是一个离散型随机变量, $i = 1,2,\dots ,n$ .并设 $X_{i}$ 的所有可能取值 (有限个或可数个) 为 $\{a_{i1},a_{i2},\dots \}$ $i = 1,2,\dots ,n$ ,则称
>
> $$p(j_{1},j_{2},\cdots,j_{n})=P(X_{1}=a_{1j_{1}},X_{2}=a_{2j_{2}},\cdots,X_{n}=a_{n j_{n}}),\quad j_{1},j_{2},\cdots,j_{n}=1,2,\cdots \tag{3.1}$$
>
> 为 $n$ 维随机变量 $X$ 的联合概率质量函数或联合分布律。

容易证明联合分布律具有下列性质:

(1) $p(j_{1},j_{2},\dots ,j_{n})\geqslant 0,\quad j_{i} = 1,2,\dots ,i = 1,2,\dots ,n;$

(2) $\sum\limits_{j_1,j_2,\cdots,j_n}p(j_1,j_2,\cdots,j_n)=1.$

[元宝的解释](https://yuanbao.tencent.com/bot/app/share/chat/mMaixGgwd745)

例 3.2 期末有高等数学和普通物理两门课程的考试, 高等数学先考. 对某些同学而言, 第一门课程的成绩对第二门课程成绩有影响. 设某学生高等数学考试优秀的概率为 0.6, 若高等数学成绩优秀, 则他的普通物理考试优秀的概率为 0.8, 反之, 若他的高等数学成绩良好或以下, 则物理考试成绩为良好或以下的概率为 0.7. 求该学生两门课程考试得分概率的所有情况.

解令 $X = I_{A}$ $Y = I_{B}$ .其中 $A = \left\{ \begin{array}{l l} \end{array} \right.$ 高等数学考试成绩优秀 $\}$ $B = \left\{ \begin{array}{l l} \end{array} \right.$ 普通物理考试成绩优秀}. 题意就是求 $X,Y$ 的联合分布.

$$
\begin{array}{r l} & {P(X = 1,Y = 1) = P(Y = 1|X = 1)P(X = 1) = 0.8\times 0.6 = 0.48,}\\ & {P(X = 1,Y = 0) = P(Y = 0|X = 1)P(X = 1) = 0.2\times 0.6 = 0.12,}\\ & {P(X = 0,Y = 1) = P(Y = 1|X = 0)P(X = 0) = 0.3\times 0.4 = 0.12,}\\ & {P(X = 0,Y = 0) = P(Y = 0|X = 0)P(X = 0) = 0.7\times 0.4 = 0.28.} \end{array}
$$

列表表示如下:

<table><tr><td rowspan="2">X</td><td colspan="2">Y</td></tr><tr><td>0</td><td>1</td></tr><tr><td>0</td><td>0.28</td><td>0.12</td></tr><tr><td>1</td><td>0.12</td><td>0.48</td></tr></table>

例 3.3 (多项分布) 设 $A_{1},A_{2},\dots,A_{n}$ 为某一试验下的完备事件群, 即 $A_{1},A_{2},\dots ,A_{n}$ 两两不相容且和为 $\Omega$ .记 $p_{k} = P(A_{k})(k = 1,2,\dots ,n)$ ,则 $p_{k}\geqslant 0,p_{1} + p_{2} + \dots +p_{n} = 1$ 现将试验独立重复进行 $N$ 次, 分别用 $X_{i}$ 表示事件 $A_{i}$ 出现的次数 $(i = 1,2,\dots ,n)$ .则 $X = (X_{1},X_{2},\dots ,X_{n})$ 为一离散型随机变量, 试求 $X$ 的分布函数. 此分布律称为多项分布, 记为 $M(N;p_{1},p_{2},\dots ,p_{n})$

解 由于试验独立进行, 总的结果数为 $N$ , 记结果 $A_{i}$ 出现的次数为 $k_{i}$ , 则 $k_{1} + k_{2} + \dots + k_{n} = N$ . 因此相当于多组组合, 所以

$$
\begin{array}{l}{{P(X_{1}=k_{1},X_{2}=k_{2},\cdots,X_{n}=k_{n})=\frac{N!}{k_{1}!k_{2}!\cdots k_{n}!}P(\underbrace{A_{1}\cdots A_{1}}_{k_{1}\uparrow\uparrow}\cdots\underbrace{A_{n}\cdots A_{n}}_{k_{n}\uparrow\uparrow}}}\\ {{=\frac{N!}{k_{1}!k_{2}!\cdots k_{n}!}p_{1}^{k_{1}}\cdots p_{n}^{k_{n}},}}\end{array}
$$

其中 $k_{1}, k_{2}, \dots , k_{n}$ 为非负整数且 $k_{1} + k_{2} + \dots + k_{n} = N$ .

### 连续型多维随机变量的联合密度函数

回想我们定义一元连续型随机变量的思路, 对随机变量在 $\mathbb{R}$ 上任意 (可测) 区间的概率, 通过寻找其概率密度函数这一本质工具, 从而可以将其表示为概率密度函数在该区间上的积分. 由于多维欧式空间和直线有着相似的优良性质, 一元连续型随机变量的定义可以自然地推广到二维和多维场合, 我们首先看二维连续型随机变量的定义:

> [!note] 定义 3.5 二维连续型随机变量
> 设 $(X, Y) \sim F(x, y)$ , 若存在可积的非负函数 $f(x, y)$ , 使得对于 $\forall (x, y) \in \mathbb{R}^{2}$ , 有
> $$F(x, y) = \int_{-\infty}^{x} \int_{-\infty}^{y} f(u, v) \mathrm{d}u \mathrm{d}v, \tag{3.2}$$
> 则称 $(X, Y)$ 为二维连续型随机变量, $F(x, y)$ 称为其联合分布函数, 称 $f(x, y)$ 为其联合概率密度函数 (joint pdf), 简称联合密度函数.

> [!note] 性质 - 联合概率密度函数
> $f(x, y)$ 具有以下性质:
> (1) 对任意的 $x, y \in \mathbb{R}$ , 有 $f(x, y) \geqslant 0$
>
> (2)
$$\iint_{\mathbb{R}^{2}} f(x, y) \mathrm{d}x \mathrm{d}y = 1\tag{3.3}$$
(3) 若 $f(x, y)$ 在点 $(x_{0}, y_{0})$ 处连续, 则
$$\left. \frac{\partial^{2} F(x, y)}{\partial x \partial y} \right|_{(x_{0}, y_{0})} = f(x_{0}, y_{0}), \tag{3.4}$$
> 由此知
>
$$P(x < X \leqslant x + \mathrm{d}x, y < Y \leqslant y + \mathrm{d}y) \approx f(x, y) \mathrm{d}x \mathrm{d}y, \tag{3.5}$$
> 即 $f(x, y) \mathrm{d}x \mathrm{d}y$ 大约是二维随机变量落在矩形 $(x, x + \mathrm{d}x] \times (y, y + \mathrm{d}y]$ 中的概率.
>
> (4) 设 $G$ 是平面上的一个区域, 则
>
$$P_{\mathrm{c}}(X,Y)\in G) = \iint_{(x,y)\in G}f(x,y)\mathrm{d}x\mathrm{d}y. \tag{3.6}$$

- [ ] 这里有个问题没有解决，那就是条件概率的情形，其中一个概率是固定的，如 [概率论第三章题目](01%20好题/概率论第三章题目.md) 中的第 23 题

> 可以从质量来理解二维联合概率密度函数和联合分布函数, $f(x,y)$ 可以解释为面密度, 该公式解释为该区域的质量. 从几何角度看, 上面的公式是平面区域 $G$ 上方和曲面 $f(x,y)$ 之间的柱形体积.

> [!tip]
> 从定义可以看出, 连续型随机向量与离散型随机向量不同, 不能简单地定义为 " 每个分量都是一维连续型随机变量 ". **即使随机向量的每个分量都是连续型随机变量，它们的联合分布也不一定存在联合概率密度函数**

例 3.4 设 $X_{1}\sim U(0,1)$ , $X_{2} = X_{1}$ ,则随机向量 $(X_{1},X_{2})$ 的两个分量都是连续型随机变量, 但 $(X_{1},X_{2})$ 只能在单位正方形的对角线取非 0 值, 因而不可能存在一个非负函数 $f(x,y)$ 满足性质 (2)(因为二元黎曼可积函数在平面上任一有限线段上的积分为 0), 即 $(X_{1},X_{2})$ 不存在密度函数. [3 均匀分布](2%20随机变量及其分布.md#3%20均匀分布)

性质 (4) 中的区域 $G$ 通常用 $(x,y)$ 的若干个函数不等式来表示, 大多数情况下为由 $(x,y)$ 的线性函数和二次函数围成的.

例 3.5 设 $(X,Y)$ 的概率密度函数为
$$
f(x,y) = \frac{1}{2\pi\sigma_{1}\sigma_{2}\sqrt{1 - \rho^{2}}}\mathrm{exp}\left\{-\frac{1}{2(1 - \rho^{2})}\left[\frac{(x - a)^{2}}{\sigma_{1}^{2}} -2\rho \frac{(x - a)(y - b)}{\sigma_{1}\sigma_{2}} +\frac{(y - b)^{2}}{\sigma_{2}^{2}}\right]\right\} ,
$$
其中 $- \infty < a,b< \infty$ , $0< \sigma_{1},\sigma_{2}< \infty$, $- 1\leqslant \rho \leqslant 1.$ 称 $(X,Y)$ 服从参数为 $a,b,\sigma_{1},\sigma_{2},\rho$ 的**二元正态分布**, 记为 $N(a,b,\sigma_{1}^{2},\sigma_{2}^{2},\rho)$ .[图形参考](https://2d-ws.hep.com.cn/node2d-shinytest/BivNorm/)

例 3.6 设 $G$ 是平面上的一个有界区域, 记 $|G|$ 为 $G$ 的面积, 若
$$
(X,Y)\sim f(x,y) = \frac{1}{|G|} I_{G}(x,y),
$$
称 $(X,Y)$ 在 $G$ 上服从均匀分布.

例 3.7 设
$$
(X,Y)\sim f(x,y)=\mathrm{e}^{-(x+y)}I_{(0,\infty)\times(0,\infty)}(x,y),
$$
设区域 G 由
$$
 x+y\leqslant1,\quad x\geqslant0,\quad y\geqslant0
$$
围成 (见图 3.4). 求 $F(x,y)$ 及 $P((X,Y)\in G)$

![|154](https://image.huarenjian.cn/image/20250725220608796.png)

解 联合分布函数为
$$
\begin{aligned}F(x,y)&=\:\int_{0}^{x}\mathrm{e}^{-u}\mathrm{d}u\int_{0}^{y}\mathrm{e}^{-v}\mathrm{d}vI_{(u>0,v>0)}\\&=\:(1-\mathrm{e}^{-x})(1-\mathrm{e}^{-y})I_{(x>0,y>0)},\\
P((X,Y)\in G)&=\underset{x>0,y>0,x+y\leq1}{\operatorname*{\int\int}}\mathrm{e}^{-(x+y)}\mathrm{d}x\mathrm{d}y
\\&=\:\int_{0}^{1}\mathrm{d}x\int_{0}^{1-x}\mathrm{e}^{-(x+y)}\mathrm{d}y=\int_{0}^{1}(1-\mathrm{e}^{1-x})\mathrm{d}x\\&=\:1-2\mathrm{e}^{-1}=0.264\:2.\end{aligned}
$$
注 二维随机变量的联合分布函数和联合概率密度函数可以毫无困难地推广到 $n$ 维. 设 $\boldsymbol {X} = (X_{1}, X_{2}, \dots , X_{n})^{\mathrm{T}}$ , $\boldsymbol{x} = (x_{1}, x_{2}, \dots , x_{n})^{\mathrm{T}} \in \mathbb{R}^{n}$ , 称
$$
F(\pmb {x}) \equiv F(x_{1}, x_{2}, \dots , x_{n}) = P(X_{1} \leqslant x_{1}, X_{2} \leqslant x_{2}, \dots , X_{n} \leqslant x_{n}) \equiv P(\pmb{X} \leqslant \pmb {x})
$$
为 $n$ 维随机变量 $X$ 的联合分布函数. 若存在非负的 $n$ 元函数 $f(x_{1}, x_{2}, \dots , x_{n})$ , 使得
$$
\begin{array}{l}{{ F(\pmb x)\equiv F(x_{1},x_{2},\cdot\cdot\cdot,x_{n})=\int_{-\infty}^{\infty}\cdot\cdot\cdot\int_{-\infty}^{\infty}f(u_{1},u_{2},\cdot\cdot\cdot,u_{n})\mathrm{d}u_{1}\mathrm{d}u_{2}\cdot\cdot\cdot\mathrm{d}u_{n}}}\\ {{\qquad\equiv\int_{(-\infty)^{n}}^{x}f(u)\mathrm{d}u,}}\end{array}
$$
则 $f(\pmb {x}) \equiv f(x_{1}, x_{2}, \dots , x_{n})$ 称为 $X$ 的联合密度函数, $X$ 称为连续型的 $n$ 维随机变量, 对应的联合分布函数 $F(\pmb {x}) \equiv F(x_{1}, x_{2}, \dots , x_{n})$ 称为连续型的联合分布函数.

可以验证联合分布函数 $F(x_{1}, x_{2}, \dots , x_{n})$ 具有下述性质:

(1) $F(x_{1}, x_{2}, \dots , x_{n})$ 对每个变元单调不减;

(2) 对任意的 $1 \leqslant j \leqslant n$ 有, $\lim_{x_{j} \to -\infty} F(x_{1}, x_{2}, \dots , x_{n}) = 0$ ;
$$
\lim_{x_{1} \to \infty , x_{2} \to \infty \dots , x_{n} \to \infty} F(x_{1}, x_{2}, \dots , x_{n}) = 1.
$$
## 边缘 (际) 分布

多维随机向量的每个分量或子集均为随机变量，那么它们的分布函数可以从联合分布函数导出。我们称这些分量或子集的分布函数为边缘（际）分布函数，以强调它们可以从联合分布函数中导出来。

> [!note] 定义 3.6 边缘（际）分布

设 $(X,Y)$ 的联合分布函数为 $F(x,y)$ ，则其分量 $X$ 和 $Y$ 的分布函数 $F_{1}(x)$ 和 $F_{2}(y)$ 称为 $(X,Y)$ 或 $F$ 的边缘（际）分布 (marginal distribution).

视频扫描视频 9 的二维码观看关于边缘分布和条件分布的讲解

由于 $\{Y< \infty \} = \Omega$ ，故
$$
\begin{array}{r l} & {F_{1}(x) = P(X\leqslant x) = P(\{X\leqslant x\} \cap \Omega) = P(X\leqslant x,Y< \infty)}\\ & {\qquad = \lim_{y\to \infty}F(x,y)\equiv F(x,\infty).} \end{array}
$$
同理， $F_{2}(y) = P(Y\leqslant y) = F(\infty ,y).$

由此知联合分布可以唯一确定边缘分布. 下面分别对二维离散型和二维连续型随机变量的边缘分布进行讨论.

### 二维离散型随机变量的边缘（际）分布

设二维离散型随机变量 $(X,Y)$ 的联合分布律为
$$
P(X = x_{i},Y = y_{j}) = p_{i j},\quad i,j = 1,2,\dots ,
$$
则随机变量 $X$ 的边际分布律为
$$
\begin{array}{c}{{P(X=x_{i})=\sum_{j=1}^{\infty}P(X=x_{i},Y=y_{j})=\sum_{j=1}^{\infty}p_{i j}}}\\ {{\equiv p_{i},\quad i=1,2,\cdots .}}\end{array}
$$
同理，随机变量 $Y$ 的边缘分布律为
$$
P(Y = y_{j}) = \sum_{i = 1}^{\infty}p_{i j}\equiv p_{\cdot j},\quad j = 1,2,\dots .
$$
在例 3.2 中，由联合分布律容易得到 $X$ 的边缘分布律为
$$
P(X = 0) = 0.4,\quad P(X = 1) = 0.6,
$$
以及 $Y$ 的边缘分布律为
$$
P(Y = 0) = 0.4,\quad P(Y = 1) = 0.6.
$$
用列表表示更清楚：

<table><tr><td rowspan="2">X</td><td colspan="2">Y</td><td rowspan="2">pi.</td></tr><tr><td>0</td><td>1</td></tr><tr><td>0</td><td>0.28</td><td>0.12</td><td>0.4</td></tr><tr><td>1</td><td>0.12</td><td>0.48</td><td>0.6</td></tr><tr><td>p.j</td><td>0.4</td><td>0.6</td><td>1</td></tr></table>

例 3.8 袋中有 5 张外形相同的卡片, 3 张写上数字 $^{\ast}0^{\ast}$ ,另 2 张写上数字 $^{\ast}1^{\ast}$ .现从袋中任取两张卡片, 分别以 $X,Y$ 表示第一张和第二张卡片上的数字, 试求分别在有放回和不放回两种情形下, $(X,Y)$ 的联合分布律及 $X,Y$ 的边缘分布律.

解简单计算得到

<table><tr><td rowspan="2">Y</td><td colspan="2">X</td><td rowspan="2">p.j</td></tr><tr><td>0</td><td>1</td></tr><tr><td rowspan="2">0</td><td>9</td><td>6</td><td>3</td></tr><tr><td>25</td><td>25</td><td>5</td></tr><tr><td rowspan="2">1</td><td>6</td><td>4</td><td>2</td></tr><tr><td>25</td><td>25</td><td>5</td></tr><tr><td rowspan="2">pi.</td><td>3</td><td>2</td><td rowspan="2">1</td></tr><tr><td>5</td><td>5</td></tr></table>

<table><tr><td rowspan="2">Y</td><td colspan="2">X</td><td rowspan="2">p.j</td></tr><tr><td>0</td><td>1</td></tr><tr><td rowspan="2">0</td><td>6</td><td>6</td><td>3</td></tr><tr><td>20</td><td>20</td><td>5</td></tr><tr><td rowspan="2">1</td><td>6</td><td>2</td><td>2</td></tr><tr><td>20</td><td>20</td><td>5</td></tr><tr><td rowspan="2">pi.</td><td>3</td><td>2</td><td rowspan="2">1</td></tr><tr><td>5</td><td>5</td></tr></table>

这个例子说明, 边缘分布律不能决定联合分布律. 其中, 左边表为有放回抽取下的分布律, 右边表为不放回抽取下的分布律. 口

### 二维连续型随机变量的边缘分布

设二维连续型随机变量 $(X,Y)\sim f(x,y)$ ,由于
$$
F_{1}(x) = F(x,\infty) = \int_{-\infty}^{x}\int_{-\infty}^{\infty}f(u,y)\mathrm{d}u\mathrm{d}y
$$
右边在积分号下对 $x$ 求导, 得 $X$ 的边缘概率密度函数为
$$
f_{1}(x) = \int_{\mathbb{R}}f(x,y)\mathrm{d}y,
$$
同理, $Y$ 的边缘概率密度函数为
$$
f_{2}(y) = \int_{\mathbb{R}}f(x,y)\mathrm{d}x.
$$
> [!note] 定义 3.7 边缘概率密度函数

$X$ 和 $Y$ 的概率密度函数 $f_{1}(x)$ 和 $f_{2}(y)$ 称为二维随机变量 $(X,Y)$ 或者联合概率密度函数 $f(x,y)$ 的边缘概率密度函数 (marginal pdf), 简称边缘密度函数.

由定义不难看出, 计算二维连续型随机变量的边缘密度函数就是联合密度函数 $f(x,y)$ 对

另一个变量求积分.

例 3.9 (例 3.5 续) 二元正态分布的联合概率密度函数 $f(x_{1},x_{2})$ 可以表示为下述形式 (表示为 $n$ 元正态分布密度函数的一般形式): 如果 $(X_{1},X_{2})\sim f(x_{1},x_{2})$ ,其中概率密度函数为
$$
f(\pmb {x}) = (2\pi)^{-\frac{1}{2}}|\pmb {A}|^{-\frac{1}{2}}\exp \Big\{-\frac{1}{2} (\pmb {x} - \pmb {\mu})^{\mathrm{T}}\pmb{A}^{-1}(\pmb {x} - \pmb {\mu})\Big\} , \tag{3.7}
$$
其中 $n = 2,\pmb {x} = (x_{1},x_{2})^{\mathrm{T}}$ $\pmb {\mu} = (\mu_{1},\mu_{2})^{\mathrm{T}}$ 为常数列向量, $\mathbf{A}$ 为正定方阵, $|\mathbf{A}|$ 为 $\mathbf{A}$ 的行列式,
$$
A = \left( \begin{array}{cc}\sigma_{1}^{2} & \rho \sigma_{1}\sigma_{2} \\ \rho \sigma_{1}\sigma_{2} & \sigma_{2}^{2} \end{array} \right),
$$
其中 $|\rho |\leqslant 1$ 求 $f_{1}(x_{1})$ 和 $f_{2}(x_{2})$

解不难得到
$$
A^{-1} = \frac{1}{1 - \rho^{2}}\left( \begin{array}{cc}\sigma_{1}^{-2} & -\rho \sigma_{1}^{-1}\sigma_{2}^{-1} \\ -\rho \sigma_{1}^{-1}\sigma_{2}^{-1} & \sigma_{2}^{-2} \end{array} \right),
$$
$$
(x - \mu)^{\mathrm{T}}A^{-1}(x - \mu) = \frac{1}{1 - \rho^{2}}\left\{\frac{(x_{1} - \mu_{1})^{2}}{\sigma_{1}^{2}} -2\rho \frac{(x_{1} - \mu_{1})(x_{2} - \mu_{2})}{\sigma_{1}\sigma_{2}} +\frac{(x_{2} - \mu_{2})^{2}}{\sigma_{2}^{2}}\right\} ,
$$
$$
|A| = (1 - \rho^{2})\sigma_{1}^{2}\sigma_{2}^{2}.
$$
要得到 $X_{1}$ 的边缘概率密度函数, 只要在联合概率密度函数 $f(x_{1},x_{2})$ 中对 $x_{2}$ 积分. 作变量代换
$$
\frac{x_{2} - \mu_{2}}{\sigma_{2}} = \rho \frac{(x_{1} - \mu_{1})}{\sigma_{1}} +\sqrt{1 - \rho^{2}} t,
$$
对 $t$ 积分, 注意到标准正态分布密度函数 $\phi (x)$ 的积分为 1, 得
$$
f_{1}(x_{1}) = \frac{1}{\sqrt{2\pi}\sigma_{1}}\exp \Big\{-\frac{1}{2}\frac{(x_{1} - \mu_{1})^{2}}{\sigma_{1}^{2}}\Big\} ,
$$
同理,
$$
f_{2}(x_{2}) = \frac{1}{\sqrt{2\pi}\sigma_{2}}\exp \Big\{-\frac{1}{2}\frac{(x_{2} - \mu_{2})^{2}}{\sigma_{2}^{2}}\Big\} ,
$$
可以看到, 随机变量 $X,Y$ 都服从正态分布, 但是它们都与参数 $\rho$ 无关, 这说明联合分布可以唯一确定边缘分布, 但是两个边缘分布不能唯一确定联合分布. 口

例 3.10 设随机变量 $(X,Y)$ 有如下的联合概率密度函数:
$$
f(x,y) = \frac{1}{2}\left[\frac{1}{2\pi\sqrt{(1 - \rho^{2})}}\exp \left\{-\frac{1}{2(1 - \rho^{2})}\left(x^{2} - 2\rho xy + y^{2}\right)\right\} +\right.
$$
$$
\frac{1}{2\pi\sqrt{(1 - \rho^{2})}}\exp \left\{-\frac{1}{2(1 - \rho^{2})}\left(x^{2} + 2\rho xy + y^{2}\right)\right\} \Biggr ],
$$
则不难验证, 它的两个边缘概率密度函数都是正态分布密度函数.

解 事实上, 在例 3.9 中, 取 $\mu_{1} = \mu_{2} = 0, \sigma_{1} = \sigma_{2} = 1$ , 则容易得到
$$
f_{1}(x) = \frac{1}{\sqrt{2\pi}}\mathrm{e}^{-\frac{x^{2}}{2}}, \quad f_{2}(y) = \frac{1}{\sqrt{2\pi}}\mathrm{e}^{-\frac{y^{2}}{2}}.
$$
本例也说明边缘概率密度函数不能决定联合概率密度函数.

例 3.11 考虑两个概率密度函数
$$
\begin{array}{c}p(x, y) = x + y, \qquad 0 < x, y < 1, \\ q(x, y) = \left(x + \frac{1}{2}\right)\left(y + \frac{1}{2}\right), \qquad 0 < x, y < 1, \end{array}
$$
试求边缘概率密度.

解 易得所求边缘概率密度都是如下形式:
$$
f(t) = t + \frac{1}{2}, \quad 0 < t < 1.
$$
这说明边缘概率密度函数不能决定联合概率密度函数.

注 多维随机变量的边缘分布和边缘密度函数

(1) 边缘分布的概念可以推广到多维随机变量, 其中仅仅是把随机变量换成随机向量. 设 $\boldsymbol{X} = (X_{1}, X_{2}, \dots , X_{n})$ , 从这 $n$ 个随机变量中任取 $k$ 个 $X_{n_{1}}, X_{n_{2}}, \dots , X_{n_{k}}$ , 记 $U = (X_{n_{1}}, X_{n_{2}}, \dots , X_{n_{k}})$ , 为方便起见, 不妨设 $U = (X_{1}, X_{2}, \dots , X_{k})$ , 剩下的 $n - k$ 个随机变量记为 $V = (X_{k + 1}, X_{k + 2}, \dots , X_{n})$ , 则 $U$ 的分布就称为 $n$ 维随机变量 $X$ 的边缘分布, 记为 $F_{U}(u)$ , 其中 $\boldsymbol{u} = (x_{1}, x_{2}, \dots , x_{k})$ , 注意到
$$
\begin{array}{r l} & {F_{U}(\pmb {u}) = P(X_{1}\leqslant x_{1},\dots ,X_{k}\leqslant x_{k},\dots ,X_{k + 1}< \infty ,\dots X_{n}< \infty)}\\ & {\qquad = F(x_{1},\dots ,x_{k},\infty ,\dots ,\infty)\equiv F(\pmb {u},\infty ,\dots ,\infty)} \end{array}
$$
即在联合分布函数中, 把另一个变量用 $\infty$ 代替就得到边缘分布.

(2) 类似于讨论二元随机变量的边缘密度函数, 边缘密度函数等于联合密度函数对另一个变量的积分. 用随机向量 $(u, v)$ 代替二元函数中的 $(x, y)$ , 得到多维随机向量的边缘密度函数等于联合密度函数对另一个变量 $v$ 的积分, 其中 $v = (x_{k + 1}, x_{k + 2}, \dots , x_{n})$ , 即
$$
f_{U}(u) = \int_{\mathbb{R}^{n - k}} f(u, v) \mathrm{d}v,
$$
其中 $\mathrm{d}v = \mathrm{d}x_{k + 1} \mathrm{~d}x_{k + 2} \dots \mathrm{~d}x_{n}$ .

(3) $n$ 维随机变量的边缘分布函数有 $2^{n} - 2$ 个.

## 条件分布

一个随机变量 (或向量) 的条件概率分布, 就是在给定 (或已知) 某种条件 (某种信息) 下该随机变量 (向量) 的概率分布.

当 $(X,Y)$ 为二维离散型随机变量时, 设联合分布律为
$$
P(X = x_{i},Y = y_{j}) = p_{ij}, \quad i,j = 1,2,\dots ,
$$
若 $P(Y = y_{j}) > 0$ , 则根据条件概率的定义, 在给定 $Y = y_{j}$ 下 $X$ 的条件分布律为
$$
p_{i|j} = \frac{p_{ij}}{p_{\cdot j}}, \quad i = 1,2,\dots , \tag{3.8}
$$
同理若 $P(X = x_{i}) > 0$ , 则给定 $X = x_{i}$ 下 $Y$ 的条件分布律为
$$
p_{j|i} = \frac{p_{ij}}{p_{i}}, \quad j = 1,2,\dots , \tag{3.9}
$$
当 $(X,Y)$ 为二维连续型随机变量时, 记联合概率密度函数为 $f(x,y)$ . 由于连续型随机变量取任意一点的概率为 0, 故此时不能直接使用条件概率. 但是注意到, 如果定义条件分布函数
$$
\begin{array}{r l} & {F_{X|Y}(x|y) = P(X\leqslant x|Y = y)\equiv \underset {\epsilon \to 0}{\lim}P(X\leqslant x|y\leqslant Y\leqslant y + \epsilon)}\\ & {\qquad = \underset {\epsilon \to 0}{\lim}\frac{(F(x,y + \epsilon) - F(x,y)) / \epsilon}{P(y< Y\leqslant y + \epsilon) / \epsilon}}\\ & {\qquad = \frac{\partial F(x,y)}{\partial y}\big / \frac{\partial F_{2}(y)}{\partial y}}\\ & {\qquad = \int_{-\infty}^{x}\frac{f(u,y)}{f_{2}(y)}\mathrm{d}u}\\ & {\qquad \equiv \int_{-\infty}^{x}f_{X|Y}(u|y)\mathrm{d}u,} \end{array}
$$
其中 $Y$ 的概率密度函数在 $y$ 处的值 $f_{2}(y) > 0$ (显然, $F_{X|Y}(x|y)$ 在固定 $y$ 时是一个分布函数). 根据连续型随机变量的定义和概率密度函数的性质, 上式定义了 $X$ 在给定条件 $Y = y$ 下的分布函数和概率密度函数. 也就是说, 条件分布函数 $F_{X|Y}(x|y)$ 可以表示为非负函数 $f_{X|Y}(x|y)$ 的积分, 故其为概率密度函数, 则定义

> [!note] 定义 3.8 条件概率密度函数

如果 $Y$ 的概率密度函数在 $y$ 处的值 $f_{2}(y) > 0$ , 那么称
$$
f_{X|Y}(x|y) = \frac{f(x,y)}{f_{2}(y)} \tag{3.10}
$$
为给定 $Y = y$ 下随机变量 $X$ 的条件概率密度函数 (conditional pdf), 简称条件密度函数. 同理, 给定 $X = x$ 下随机变量 $Y$ 的条件概率密度函数 $f_{Y|X}(y|x)$ 为
$$
f_{Y|X}(y|x) = \frac{f(x,y)}{f_{1}(x)}, \quad f_{1}(x) > 0. \tag{3.11}
$$
给定 $X = x$ 下随机变量 $Y$ 的条件密度函数也常常表为 $Y|X = x \sim f_{Y|X}(y|x)$ , 或 $Y|x \sim f_{Y|X}(y|x)$ .

由条件密度函数的定义, 我们有
$$
f(x,y) = f_{Y|X}(y|x)f_{1}(x) = f_{X|Y}(x|y)f_{2}(y). \tag{3.12}
$$
由此得到连续型随机变量的贝叶斯公式的密度函数形式:
$$
f_{Y|X}(y|x) = \frac{f(x,y)}{f_{1}(x)} = \frac{f_{X|Y}(x|y)f_{2}(y)}{f_{1}(x)}, \tag{3.13}
$$
$$
f_{X|Y}(x|y) = \frac{f(x,y)}{f_{2}(y)} = \frac{f_{Y|X}(y|x)f_{1}(x)}{f_{2}(y)}. \tag{3.14}
$$
注 (条件分布的物理直观意义) 从物理观点看, 设平面上在格点 $(i,j)$ 上有质量 $p_{ij}, i,j = 1,2, \dots , p_{\cdot j}$ 就是直线 $y = j$ 的质量. $p_{i|j}$ 就是格点 $(i,j)$ 上质量与直线 $y = j$ 质量的比值. 如果平面质量有面密度 $f(x,y)$ , $f_{X|Y}(x|y)$ 就是当 $\Delta x \rightarrow 0, \Delta y \rightarrow 0$ 时矩形 $[x,x + \Delta x] \times [y,y + \Delta y]$ 与条形 $(- \infty , \infty) \times (y,y + \Delta y]$ 质量比值的极限. 而条件分布函数 $F_{X|Y}(x|y)$ 就是当 $\Delta y \rightarrow 0$ 时, 条形 $(- \infty , x] \times (y,y + \Delta y]$ 与条形 $(- \infty , \infty) \times (y,y + \Delta y]$ 质量比值的极限.

例 3.12 从 (0,1) 中任取一点 $X$ , 再从 $(0,X)$ 中任取一点 $Y$ , 求 $Y$ 的密度函数以及 $F_{X|Y}(0.5|0.25)$ .

解 由题意, $X \sim U(0,1)$ , $Y|X = x \sim U(0,x)$ , 所以由公式 (3.10), $(X,Y)$ 的联合密度为
$$
f(x,y) = f_{1}(x)f_{Y|X}(y|x) = I_{(0,1)}(x) \cdot \frac{1}{x} I_{(0,x)}(y),
$$
当 $0 < y < 1$ 时,
$$
\begin{array}{l}{{f_{2}(y)=\int_{-\infty}^{\infty}f(x,y)\mathrm{d}x=\int_{0}^{1}\frac{1}{x}I_{(y< x)}\mathrm{d}x}}\\ {{=\int_{y}^{1}\frac{1}{x}\mathrm{d}x=-\ln(y)I_{(0,1)}(y),}}\end{array}
$$
由条件密度函数定义知
$$
f_{X|Y}(x|0.25) = \frac{f(x,0.25)}{f_{2}(0.25)} = \frac{1}{x \ln 4} I_{(0.25,1)}(x),
$$
因此
$$
F_{X|Y}(0.5|0.25) = \int_{-\infty}^{0.5} f_{X|Y}(x|0.25) \mathrm{d}x = 0.5.
$$
例 3.13 设某地区成年男子的身高 $H(\mathrm{cm})$ 服从正态分布 $N(172,36)$ , 当身高 $H = h$ 时, 体重 $W$ (单位: $\mathrm{kg}$ ) 服从正态分布 $N(h - 105,49)$ . 求体重 $W$ 的分布.

解 由题意,
$$
f_{H}(h) = \frac{1}{\sqrt{2\pi}\times6}\exp \Big\{-\frac{(h - 172)^{2}}{2\times36}\Big\} ,
$$
$$
f_{W|H}(w|h) = \frac{1}{\sqrt{2\pi}\times7}\exp \Big\{-\frac{(w - (h - 105))^{2}}{2\times49}\Big\} .
$$
所以
$$
\begin{array}{l}{{f(h,w)=f_{H}(h)f_{W|H}(w|h)}}\\ {{\mathrm{~}=\frac{1}{2\pi\times42}\exp\Big\{-\frac{1}{2}\Big(\frac{(h-172)^{2}}{36}+\frac{(w-(h-105))^{2}}{49}\Big)\Big\}.}}\end{array}
$$
在 $f(h,w)$ 的指数中, 对变量 $h$ 配平方, 然后对 $h$ 积分, 得
$$
f_{W}(w) = \int_{-\infty}^{\infty}f(h,w)\mathrm{d}h = \frac{1}{\sqrt{2\pi\times85}}\exp \Big\{-\frac{(w - 67)^{2}}{2\times85}\Big\} ,
$$
即 $W\sim N(67,85)$

例 3.14 设 $(X,Y)\sim N(\mu_{1},\mu_{2},\sigma_{1}^{2},\sigma_{2}^{2};\rho)$ ,求 $Y|x$ 的分布.

解 由二元正态分布随机变量密度函数的定义, $X\sim N(\mu_{1},\sigma_{1}^{2})$ ,密度函数记为 $f_{1}(x)$ ,记
$$
x_{1} = \frac{x - \mu_{1}}{\sigma_{1}},\quad y_{1} = \frac{y - \mu_{2}}{\sigma_{2}},
$$
则
$$
\begin{array}{r l} & {f_{Y|X}(y|x) = \frac{f(x,y)}{f_{1}(x)}}\\ & {\qquad = \frac{1}{2\pi\sqrt{(1 - \rho^{2})\sigma_{1}\sigma_{2}}}\exp \Big\{-\frac{1}{2(1 - \rho^{2})} (x_{1}^{2} - 2\rho x_{1}y_{1} + y_{1}^{2})\Big\}}\\ & {\qquad = \frac{1}{\sqrt{2\pi\sigma_{1}}}\exp \Big\{-\frac{1}{2} x_{1}^{2}\Big\}}\\ & {\qquad = \frac{1}{\sqrt{2\pi(1 - \rho^{2})\sigma_{2}}}\exp \Big\{-\frac{1}{2(1 - \rho^{2})} (y_{1} - \rho x_{1})^{2}\Big\}}\\ & {\qquad = \frac{1}{\sqrt{2\pi(1 - \rho^{2})\sigma_{2}}}\exp \Big\{-\frac{1}{2(1 - \rho^{2})\sigma_{2}^{2}} (y - (\mu_{2} + \rho \sigma_{2}\sigma_{1}^{-1}(x - \mu_{1})))^{2}\Big\} ,} \end{array}
$$
即 $Y|x\sim N(\mu_{2} + \rho \sigma_{2}\sigma_{1}^{- 1}(x - \mu_{1}),(1 - \rho^{2})\sigma_{2}^{2})$

注 ( $n$ 维随机变量的条件密度函数) 把随机变量 $X,Y$ 都换成随机向量 $X,Y$ ,我们可以把两个随机变量的条件密度函数推广到 $n$ 维随机变量的条件密度函数. 设
$$
\begin{array}{c}{{x=(x_{1},x_{2},\cdots,x_{k}),y=(y_{1},y_{2},\cdots,y_{n-k}),}}\\ {{f(x,y)=f(x_{1},x_{2},\cdots,x_{k},y_{1},y_{2},\cdots,y_{n-k}).}}\end{array}
$$
记随机向量 $X,Y$ 的边缘密度函数分别为 $f_{X}(x)$ 和 $f_{Y}(y)$ ,则给定随机向量 $Y = y$ 下随机

向量 $X$ 的条件密度 $f_{X|Y}(x|y)$ 定义为
$$
f_{X|Y}(x|y) = \frac{f(x,y)}{f_{Y}(y)}, \quad f_{Y}(y) > 0.
$$
同理, 给定随机向量 $X = x$ 下随机向量 $Y$ 的条件密度 $f_{Y|X}(y|x)$ 定义为
$$
f_{Y|X}(y|x) = \frac{f(x,y)}{f_{X}(x)}, \quad f_{X}(x) > 0.
$$
类似于二维随机变量的贝叶斯公式的密度函数形式, 对 $n$ 维随机变量也成立.

## 相互独立的随机变量

在上一小节中, 我们知道由 $(X,Y)$ 的联合分布可以唯一确定边缘分布, 反之不必成立. 什么时候边缘分布可以唯一确定联合分布? 在研究事件独立性时, 我们知道两个事件同时发生的概率等于每个事件发生概率乘积的充要条件是这两个事件相互独立. $(X,Y)$ 的联合分布
$$
F(x,y) = P(\{X\leqslant x\} \cap \{Y\leqslant y\})
$$
也是两个事件同时发生的概率, 要上式等于 $F_{1}(x)$ 和 $F_{2}(y)$ 的乘积, 就需要事件 $\{X\leqslant x\}$ 和 $\{Y\leqslant y\}$ 相互独立. 不过由于 $(x,y)$ 可以在平面上变化, 所以这不是两个事件了. 为此我们需要引入随机变量相互独立的概念.

> [!note] 定义 3.9 随机变量相互独立

设随机变量 $X,Y$ 的联合分布为 $F(x,y)$ , 边缘分布为 $F_{1}(x),F_{2}(y)$ . 若 $\forall (x,y)\in \mathbb{R}^{2}$ , 都有
$$
F(x,y) = F_{1}(x)F_{2}(y), \tag{3.15}
$$
则称随机变量 $X,Y$ 相互独立.

视频扫描视频 10 的二维码观看关于随机变量的独立性的讲解

直观来看, 称随机变量 $X,Y$ 相互独立是指: 若 $A$ 是与随机变量 $X$ 相关的任意事件, $B$ 是与随机变量 $Y$ 相关的任意事件, 则事件 $A,B$ 相互独立. 所以随机变量独立的定义也等价于: $\forall B_{1}\in \mathbb{R},B_{2}\in \mathbb{R}$ , 都有
$$
P(X\in B_{1},Y\in B_{2}) = P(X\in B_{1})P(Y\in B_{2}). \tag{3.16}
$$
若 $(X,Y)$ 是离散型随机变量, 分布律为 $P(X = x_{i},Y = y_{j}) = p_{ij},i,j = 1,2,\dots$ , 则 $X,Y$ 相互独立等价于
$$
p_{ij} = p_{i}.p_{.j} \quad \forall i,j = 1,2,\dots . \tag{3.17}
$$
事实上, 充分性显然, 下证必要性. 因为 $X,Y$ 相互独立, 所以有
$$
F(x,y) = F_{1}(x)F_{2}(y),
$$
因此, 对任意的取值对 $(x_{i}, y_{j})$ , 有
$$
\begin{array}{r l} & {P(X = x_{i},Y = y_{j}) = F(x_{i},y_{j}) - F(x_{i - 1},y_{i}) - F(x_{i},y_{j - 1}) + F(x_{i - 1},y_{j - 1})}\\ & {\qquad = [F_{1}(x_{i}) - F_{1}(x_{i - 1})]F_{2}(y_{j}) - [F_{1}(x_{i}) - F_{1}(x_{i - 1})]F_{2}(y_{j - 1})}\\ & {\qquad = P(X = x_{i})P(Y = y_{j}).} \end{array}
$$
从而得证.

若 $(X, Y)$ 是连续型随机变量, 有联合概率密度函数 $f (x, y)$ 和边缘概率密度函数 $f_{1}(x)$ $f_{2}(y)$ ,则不难证明 $X, Y$ 相互独立等价于
$$
f(x,y) = f_{1}(x)f_{2}(y),\quad \forall (x,y)\in \mathbb{R}^{2}. \tag{3.18}
$$
上式等价于密度函数 $f (x, y)$ 可以分离变量, 即若有
$$
f(x,y) = g_{1}(x)g_{2}(y),\quad \forall (x,y)\in \mathbb{R}^{2}, \tag{3.19}
$$
其中 $g_{1}(x), g_{2}(y)$ 不必是概率密度函数

在实际问题中, 随机变量的独立性是可以知道的, 如在掷骰子的游戏中, 令 $X_{i} = \left\{ \begin{array}{ll} \end{array} \right.$ 第 $i$ 次掷出的点数 $\}$ $i = 1,2$ .则第 2 次掷得点数与第 1 次掷得点数没有任何关系, $X_{1}, X_{2}$ 是相互独立的. 在购买彩票中, 这次开出什么号码与下次开出什么号码没有任何关系, 也是独立的. 我们可以利用随机变量的独立性来计算有关随机事件发生的概率.

例 3.15 (会面问题) 两人约定上午 $9:00\sim 10:00$ 在公园东大门会面, 先到者等候 $20 \mathrm{min}$ , 如果另一人还没到就可以离开. 求两人能会面的概率.

解设 $X, Y$ 分别表示两人到达的时间, 由题意, $X\sim$ $U (9,10), Y\sim U (9,10)$ 且 $X, Y$ 相互独立. 两人能会面: $|X - Y|\leqslant 1 / 3$ (图 3.5). 所以两人能会面的概率为
$$
\begin{array}{l}{P\left(|X - Y|\leqslant 1 / 3\right) = \iint_{|x - y|\leqslant 1 / 3}f(x,y)\mathrm{d}x\mathrm{d}y}\\ {= \iint_{|x - y|\leqslant 1 / 3}\mathrm{d}x\mathrm{d}y = 1 - \iint_{|x - y| > 1 / 3}\mathrm{d}x\mathrm{d}y}\\ {= 1 - 2\times \frac{1}{2}\left(\frac{2}{3}\right)^{2} = \frac{5}{9}.} \end{array}
$$
![](images/65d53000b512dcc1b0925988cb6a2ce96b4317e9235e86af9fb69da59e19f735.jpg)

图 3.5 会面问题

例 3.16 (不独立的随机变量) 设 $(X, Y)$ 的联合密度函数为
$$
f(x,y) = \frac{1}{\pi} I_{(x^{2} + y^{2}\leqslant 1)}(x,y),
$$
求证 $X, Y$ 不相互独立.

证 用反证法, 若 $X, Y$ 相互独立, 则 $\forall (x, y)$ , 有 $f (x, y) = f_{1}(x) f_{2}(y)$ . 如图 3.6, 在单位圆和外接正方形之间任取一点 $(x, y)$ , 则 $f (x, y) = 0$ , 而
$$
f_{2}(y) = \int_{-1}^{1}f(x,y)\mathrm{d}x = \frac{1}{\pi}\int_{-\sqrt{1 - y^{2}}}^{\sqrt{1 - y^{2}}}\mathrm{d}x > 0.
$$
同理, $f_{1}(x) > 0$ , 所以在该点 $0 = f (x, y)\neq f_{1}(x) f_{2}(y)$ $>0$ , 矛盾. 因为单位圆和外接正方形之间的面积大于 0, 所以 $X, Y$ 不相互独立.

例 3.17 (两个正态分布随机变量独立的充要条件) 设 $(X, Y)\sim N (\mu_{1},\mu_{2},\sigma_{1}^{2},\sigma_{2}^{2},\rho)$ , 证明: $X, Y$ 相互独立 $\Leftrightarrow$ $\rho = 0$

证充分性. 若 $\rho = 0$ , 因为 $f (x, y) = g_{1}(x) g_{2}(y)$ , 即联合密度函数可分离, 所以 $(X, Y)$ 相互独立.

![](images/70ce56236b01e7592abb8802c7eff5b27d0de937b07e30d2f59a0e41a2c080e7.jpg)

图 3.6 单位圆和外接正方形

必要性. 若 $(X, Y)$ 相互独立, 则 $f (x, y) = f_{1}(x) f_{2}(y)$ $\forall (x, y)\in \mathbb{R}^{2}$ , 特别取 $(x, y) = (\mu_{1},\mu_{2})$ , 有
$$
f(\mu_{1},\mu_{2}) = \frac{1}{2\pi\sigma_{1}\sigma_{2}\sqrt{1 - \rho^{2}}} = f_{1}(\mu_{1})f_{2}(\mu_{2}) = \frac{1}{\sqrt{2\pi}\sigma_{1}}\times \frac{1}{\sqrt{2\pi}\sigma_{2}},
$$
从而 $\rho = 0$

两个随机变量相互独立可以推广到 $n$ 个随机变量相互独立

> [!note] 定义 3.10 多维随机向量的相互独立性

设 $n$ 维随机变量 $(X_{1}, X_{2},\dots ,X_{n})\sim F (x_{1}, x_{2},\dots ,x_{n})$ , 记 $X_{i}\sim F_{i}(x_{i})$ , $i = 1,2,\dots ,$ $n$ . 若对任意 $(x_{1}, x_{2},\dots ,x_{n})^{\mathrm{T}}\in \mathbb{R}^{n}$ 都成立
$$
F(x_{1},x_{2},\dots ,x_{n}) = F_{1}(x_{1})F_{2}(x_{2})\dots F_{n}(x_{n}),
$$
则称随机变量 $X_{1}, X_{2},\dots ,X_{n}$ 相互独立.

性质利用分布函数与分布律或概率密度函数之间的关系, 容易得到

(1) 若随机向量 $(X_{1}, X_{2},\dots ,X_{n})$ 是 $n$ 维离散型随机向量, 若对所有可能取值 $(x_{1k_{1}}, x_{2k_{2}},\dots ,x_{nk_{n}})$ 都成立
$$
P(X_{1} = x_{1k_{1}},X_{2} = x_{2k_{2}},\dots ,X_{n} = x_{nk_{n}}) = \prod_{i = 1}^{n}P(X_{i} = x_{ik_{i}}),
$$
则称随机变量 $X_{1}, X_{2},\dots ,X_{n}$ 相互独立.

(2) 设连续型随机向量 $(X_{1}, X_{2},\dots ,X_{n})\sim f (x_{1}, x_{2},\dots ,x_{n})$ , $X_{i}\sim f_{i}(x_{i})$ , $i = 1,2,\dots ,n$ , 若对任意 $(x_{1}, x_{2},\dots ,x_{n})^{\mathrm{T}}\in \mathbb{R}^{n}$ 都成立
$$
f(x_{1},x_{2},\dots ,x_{n}) = \prod_{i = 1}^{n}f_{i}(x_{i}),
$$
则称随机变量 $X_{1}, X_{2}, \dots , X_{n}$ 相互独立.

(3) 若 $n$ 个随机变量 $X_{1}, X_{2}, \dots , X_{n}$ 相互独立, 则随机向量 $(X_{1}, X_{2}, \dots , X_{k})$ 和随机向量 $(X_{k + 1}, X_{k + 2}, \dots , X_{n})$ 相互独立. 当然, 随机向量的函数 $Y_{1} = g_{1}(X_{1}, X_{2}, \dots , X_{k})$ 和 $Y_{2} = g_{2}(X_{k + 1}, X_{k + 2}, \dots , X_{n})$ 也是相互独立的.

然而一般来说, 仅由某一部分独立无法推出 $X_{1}, X_{2}, \dots , X_{n}$ 相互独立. 见下例.

例 3.18 若 $X, Y$ 相互独立, 都服从 $- 1$ 和 1 这两点上的等可能分布. $Z = XY$ ,证明: $Z, X, Y$ 两两独立但不相互独立.

证 由题设知 $X, Y, Z$ 均服从 $- 1$ 和 1 这两点上的等可能分布, 注意到
$$
\begin{array}{c}P(Z = 1, X = 1) = P(X = 1, Y = 1) = P(X = 1)P(Y = 1) \\ = \frac{1}{4} = P(Z = 1)P(X = 1), \end{array}
$$
$$
\begin{array}{c}P(Z = 1, X = -1) = P(X = -1, Y = -1) = P(X = -1)P(Y = -1) \\ = \frac{1}{4} = P(Z = 1)P(X = -1), \end{array}
$$
$$
\begin{array}{c}P(Z = -1, X = 1) = P(X = 1, Y = -1) = P(X = 1)P(Y = -1) \\ = \frac{1}{4} = P(Z = -1)P(X = 1), \end{array}
$$
$$
\begin{array}{c}P(Z = -1, X = -1) = P(X = -1, Y = 1) = P(X = -1)P(Y = 1) \\ = \frac{1}{4} = P(Z = -1)P(X = -1), \end{array}
$$
因此, $Z$ 与 $X$ 相互独立. 类似可证 $Z$ 与 $Y$ 相互独立. 即 $Z, X, Y$ 两两独立. 但是
$$
P(Z = 1, X = 1, Y = -1) = 0 \neq P(Z = 1)P(X = 1)P(Y = -1) = \frac{1}{8}.
$$
即 $Z, X, Y$ 不相互独立. 从而得证.

## 随机向量函数的分布

我们已经知道若随机变量 $Y$ 是随机变量 $X$ 的函数时, $Y$ 的分布可以由 $X$ 的分布表达. 把随机变量 $X, Y$ 推广到随机向量时, 也有相应的表达. 我们仅仅讨论二维连续型随机向量的函数, 离散情况和多维情况没有实质性的区别, 仅仅是表达式复杂点.

设 $(X, Y) \sim f (x, y)$ , $Z = g (X, Y)$ 为一维随机变量, $A \subset \mathbb{R}$ ,则
$$
P(Z \in A) = \iint \limits_{g(x, y) \in A} f(x, y) \mathrm{d}x \mathrm{d}y,
$$
特别当 $A = (- \infty , z]$ 时, $Z$ 的分布函数 $F_{Z}$ 为
$$
F_{Z}(z) = P(Z \leqslant z) = \iint \limits_{g(x, y) \leqslant z} f(x, y) \mathrm{d}x \mathrm{d}y, \tag{3.20}
$$
若 $Z_{1} = g_{1}(X, Y), Z_{2} = g_{2}(X, Y)$ 分别为一维随机变量, $A \subset \mathbb{R}^{2}$ , 则 $Z_{1}, Z_{2}$ 的联合分布为
$$
P((Z_{1}, Z_{2}) \in A) = \iint \limits_{(g_{1}(x,y), g_{2}(x,y)) \in A} f(x,y) \mathrm{d}x \mathrm{d}y,
$$
特别当 $A = (- \infty , z_{1}] \times (- \infty , z_{2}]$ 时, $(Z_{1}, Z_{2})$ 的联合分布函数 $F_{\mathbf{Z}}(z_{1}, z_{2})$ 为
$$
F_{\mathbf{Z}}(z_{1}, z_{2}) = P(Z_{1} \leqslant z_{1}, Z_{2} \leqslant z_{2}) = \iint \limits_{\substack{g_{1}(x,y) \leqslant z_{1} \\ g_{2}(x,y) \leqslant z_{2} }} f(x,y) \mathrm{d}x \mathrm{d}y. \tag{3.21}
$$
有了分布函数, 对它求导即可得密度函数. 为计算 (3.21) 式, 有时要用到二元函数的变换. 令 $u = g_{1}(x, y), v = g_{2}(x, y), (u, v)$ 和 $(x, y)$ 一一对应. 反函数记为 $x = \phi_{1}(u, v), y = \phi_{2}(u, v)$ 且都有一阶连续偏导数, 记 $(x, y)$ 对 $(u, v)$ 和 $(u, v)$ 对 $(x, y)$ 的雅可比 (Jacobi) 行列式分别为
$$
\frac{\partial(\phi_{1}(u,v), \phi_{2}(u,v))}{\partial(u,v)} \neq 0, \quad \frac{\partial(u,v)}{\partial(x,y)} \bigg|_{(x = \phi_{1}(u,v), y = \phi_{2}(u,v))}.
$$
注意到
$$
\frac{\partial(x,y)}{\partial(u,v)} = \left(\frac{\partial(u,v)}{\partial(x,y)}\right)^{-1}, \tag{3.22}
$$
则作变换后
$$
F_{\mathbf{Z}}(z_{1}, z_{2}) = \iint \limits_{\substack{g_{1}(x,y) \leqslant z_{1} \\ g_{2}(x,y) \leqslant z_{2} }} f(x,y) \mathrm{d}x \mathrm{d}y = \iint \limits_{\substack{u \leqslant z_{1} \\ v \leqslant z_{2} }} f(\phi_{1}(u,v), \phi_{2}(u,v)) \left| \frac{\partial(x,y)}{\partial(u,v)} \right| \mathrm{d}u \mathrm{d}v, \tag{3.23}
$$
在 (3.23) 式中对 $z_{1}, z_{2}$ 求混合偏导, 得
$$
f_{\mathbf{Z}}(z_{1}, z_{2}) = f(\phi_{1}(z_{1}, z_{2}), \phi_{2}(z_{1}, z_{2})) \left| \frac{\partial(\phi_{1}(u,v), \phi_{2}(u,v))}{\partial(u,v)} \right|_{(u,v) = (z_{1}, z_{2})}. \tag{3.24}
$$
特别地, 当随机变量 $X, Y$ 相互独立时, 有 $f (x, y) = f_{1}(x) f_{2}(y)$ , 计算会方便进行.

视频扫描视频 11 的二维码观看关于两个随机变量的函数的分布讲解.

在多维随机变量场合, 更一般地有, 如果 $X = (X_{1}, X_{2},\dots ,X_{n})$ 是 $n$ 维连续型随机向量, 具有联合概率密度函数 $f (\pmb {x}) = f (x_{1}, x_{2},\dots ,x_{n})$ .假设存在 $\mathbb{R}^{n}$ 到 $\mathbb{R}^{n}$ 的一一映射 $g$ ,其逆映射 $g^{- 1}$ 存在一阶连续偏导数, 那么 $n$ 维随机变量 $Y = g (X)$ 是连续型的, 且具有联合密度函数
$$
p(\pmb {y}) = f\left(\pmb{g}^{-1}(\pmb {y})\right) \big| J \big|_{I_{D}}(\pmb {y}), \tag{3.25}
$$
其中 $D \subset \mathbb{R}^{n}$ 是随机向量 $\pmb{y}$ 的密度非零的所有可能值的集合, $J$ 是变换的雅可比行列式, 这里 $|J|$ 为行列式 $J$ 的绝对值, 即
$$
J = \left| \frac{\partial g^{-1}}{\partial(y_{1}, y_{2}, \cdots, y_{n})} \right|.
$$
例 3.19 设随机变量 $X, Y$ 相互独立, 分别具有概率密度函数 $f_{1}(x)$ 和 $f_{2}(y)$ , 求 $X + Y$ 的概率密度函数.

解 由 $X, Y$ 相互独立及公式 (3.20)
$$
F_{X + Y}(z) = \int_{x + y\leqslant z}^{x}f_{1}(x)f_{2}(y)\mathrm{d}x\mathrm{d}y = \int_{-\infty}^{\infty}f_{1}(x)\int_{-\infty}^{z - x}f_{2}(y)\mathrm{d}y\mathrm{d}x,
$$
在积分号下对 $z$ 求导, 得
$$
\begin{array}{l}{f_{X + Y}(z) = \int_{-\infty}^{\infty}f_{1}(x)f_{2}(z - x)\mathrm{d}x,}\\ {= \int_{-\infty}^{\infty}f_{2}(y)f_{1}(z - y)\mathrm{d}y\equiv f_{1}*f_{2}(z).} \end{array}
$$
这里 $f_{1}*f_{2}(z)$ 称为 $f_{1}$ 和 $f_{2}$ 的卷积 (convolution).

也可以从变量代换角度来得到随机变量和的密度函数. 令 $U = X, V = X + Y$ , 函数 $u, v$ 对 $x, y$ 的雅可比行列式为 1, 故 (积分区域如图 3.7)
$$
\begin{array}{l}{P(X + Y\leqslant z) = \iint_{x + y\leqslant z}f(x,y)\mathrm{d}x\mathrm{d}y}\\ {= \iint_{v\leqslant z}f(u,v - u)\mathrm{d}u\mathrm{d}v}\\ {= \int_{-\infty}^{z}\mathrm{d}v\int_{-\infty}^{\infty}f(u,v - u)\mathrm{d}u.} \end{array}
$$
![](images/5e70ff32206016ae23ec9824ae039586173f3bc0a50e455d6e8047d508e23d00.jpg)

图 3.7 积分区域

由密度函数的定义
$$
f_{X + Y}(z) = \int_{-\infty}^{\infty}f(u,z - u)\mathrm{d}u.
$$
当 $X, Y$ 相互独立时, $f (u, z - u) = f_{1}(u) f_{2}(z - u)$ . 这里不需要在积分号下求导.

例 3.20 (指数分布随机变量的和与差) 设 $X$ 和 $Y$ 独立, 均服从指数分布 $E x p (\lambda)$ ,求 $Z =$ $X + Y$ 的概率密度函数.

解 由于
$$
\begin{array}{l}{f_{Z}(z) = \lambda^{2}\int_{-\infty}^{\infty}\exp \{-\lambda x\} \exp \{-\lambda (z - x)\} I_{[0,\infty)}(x)I_{[0,\infty)}(z - x)\mathrm{d}x}\\ {= \lambda^{2}\exp \{-\lambda z\} \int_{-\infty}^{\infty}I_{[0,\infty)}(x)I_{[0,\infty)}(z - x)\mathrm{d}x}\\ {= \lambda^{2}z\exp \{-\lambda z\} I_{[0,\infty)}(z).} \end{array}
$$
进一步容易得出, 如果 $X_{1}, X_{2},\dots ,X_{n}$ 相互独立且服从相同的指数分布 $E x p (\lambda)$ ,那么 $Z =$ $X_{1} + X_{2} + \dots +X_{n}$ 的概率密度函数为
$$
f_{n}(z) = \frac{\lambda^{n}}{n!} z^{n - 1}\exp \{-\lambda z\} I_{[0,\infty)}(z).
$$
该分布称为参数是 $n, \lambda$ 的 $\Gamma$ 分布, 记为 $Z \sim Ga (n, \lambda)$ . 如果相互独立的两个同类型随机变量之和仍服从同一类型的分布, 那么称此分布类型具有再生性. 因此, $\Gamma$ 分布对参数 $n$ 具有再生性.

类似地, $Z = X - Y$ 的概率密度函数为
$$
\begin{array}{r l} & {f_{Z}(z) = \lambda^{2}\int_{-\infty}^{\infty}\exp \{-\lambda x\} \exp \{-\lambda (z + x)\} I_{[0,\infty)}(x)I_{[0,\infty)}(z + x)\mathrm{d}x}\\ & {\qquad = \lambda^{2}\exp \{-\lambda z\} \int_{-\infty}^{\infty}\exp \{-2\lambda x\} I_{[0,\infty)}(x)I_{[0,\infty)}(z + x)\mathrm{d}x}\\ & {\qquad = \left\{ \begin{array}{l l}{\lambda^{2}\exp \{-\lambda z\} \int_{-z}^{\infty}\exp \{-2\lambda x\} \mathrm{d}x,} & {z\leqslant 0,}\\ {\lambda^{2}\exp \{-\lambda z\} \int_{0}^{\infty}\exp \{-2\lambda x\} \mathrm{d}x,} & {z > 0} \end{array} \right.}\\ & {\qquad = \left\{ \begin{array}{l l}{(\lambda /2)\exp \{\lambda z\} ,} & {z\leqslant 0,}\\ {(\lambda /2)\exp \{-\lambda z\} ,} & {z > 0} \end{array} \right.}\\ & {\qquad = \left\{ \begin{array}{l l}{(\lambda /2)\exp \{-\lambda z\} ,} & {z > 0} \end{array} \right.} \end{array}
$$
该分布称为拉普拉斯分布, 即独立指数分布的差是拉普拉斯分布.

例 3.21 设 $X, Y$ 相互独立, 且 $X \sim U (0,2), Y \sim U (- 1,1)$ , 求 $X + Y$ 的概率密度函数.

解令 $U = X + Y, V = Y$ , 由于 $\frac{\partial (u, v)}{\partial (x, y)} = 1$ , 故 $(U, V)$ 的联合密度函数为
$$
g(u, v) = \frac{1}{4} I_{(0,2)}(u - v)I_{(-1,1)}(v),
$$
(联合密度函数的非零区域见图 3.8), 对另一个变量求积分得到 $f_{X + Y}(u)$ 的密度函数为
$$
\begin{array}{l}{f_{X + Y}(u) = \int g(u,v)\mathrm{d}v = \frac{1}{4}\int I_{(0,2)}(u - v)I_{(-1,1)}(v)\mathrm{d}v}\\ {= \frac{1}{4}\int_{-1}^{1}I_{(0,2)}(u - v)\mathrm{d}v}\\ {= \frac{1}{4}\Big[\int_{-1}^{u}\mathrm{d}v I_{(-1,1)}(u) + \int_{u - 2}^{1}\mathrm{d}v I_{(1,3)}(u)\Big]}\\ {= \frac{1}{4}\Big[(u + 1)I_{(-1,1)}(u) + (3 - u)I_{(1,3)}(u)\Big].} \end{array}
$$
![](images/9cb5210e87a5117b6e096e0833537dca985d29469186acb65fbd793d365541d2.jpg)

例 3.22 (正态分布随机变量的和）设 $X$ 和 $Y$ 相互独立, 分别服从 $N\left (\mu_{1},\sigma_{1}^{2}\right)$ 和 $N\left (\mu_{2},\sigma_{2}^{2}\right)$ ，求 $Z = X + Y$ 的分布.

解由于
$$
\begin{array}{r l} & {f_{Z}(z) = \frac{1}{2\pi\sigma_{1}\sigma_{2}}\int_{-\infty}^{\infty}\exp \left\{-\frac{(x - \mu_{1})^{2}}{2\sigma_{1}^{2}}\right\} \exp \left\{-\frac{(z - x - \mu_{2})^{2}}{2\sigma_{2}^{2}}\right\} \mathrm{d}x}\\ & {\qquad = \frac{1}{2\pi\sigma_{1}\sigma_{2}}\int_{-\infty}^{\infty}\exp \left\{-\frac{1}{2}\left(\frac{1}{\sigma_{1}^{2}} +\frac{1}{\sigma_{2}^{2}}\right)\left[x - \left(\frac{1}{\sigma_{1}^{2}} +\frac{1}{\sigma_{2}^{2}}\right)\left(\frac{\mu_{1}}{\sigma_{1}^{2}} +\frac{z - \mu_{2}}{\sigma_{2}^{2}}\right)\right]^{2}\right\} \mathrm{d}x\times}\\ & {\qquad \exp \left\{\frac{1}{2}\left(\frac{1}{\sigma_{1}^{2}} +\frac{1}{\sigma_{2}^{2}}\right)^{-1}\left(\frac{\mu_{1}}{\sigma_{1}^{2}} +\frac{z - \mu_{2}}{\sigma_{2}^{2}}\right)^{2} - \frac{1}{2}\left(\frac{\mu_{1}^{2}}{\sigma_{1}^{2}} +\frac{(z - \mu_{2})^{2}}{\sigma_{2}^{2}}\right)\right\}}\\ & {\qquad = \frac{1}{\sqrt{2\pi}\sqrt{\sigma_{1}^{2} + \sigma_{2}^{2}}}\exp \left\{\frac{1}{2\left(\sigma_{1}^{2} + \sigma_{2}^{2}\right)}\left[-\mu_{1}^{2} - (z - \mu_{2})^{2} + 2\mu_{1}(z - \mu_{2})\right]\right\}}\\ & {\qquad = \frac{1}{\sqrt{2\pi}\sqrt{\sigma_{1}^{2} + \sigma_{2}^{2}}}\exp \left\{-\frac{\left[z - (\mu_{1} + \mu_{2})\right]^{2}}{2\left(\sigma_{1}^{2} + \sigma_{2}^{2}\right)}\right\} .} \end{array}
$$
即 $Z\sim N (\mu_{1} + \mu_{2},\sigma_{1}^{2} + \sigma_{2}^{2})$ ，即正态分布 $N (\mu ,\sigma^{2})$ 对参数 $\mu ,\sigma^{2}$ 具有再生性.

值得注意的是，这里“ $X$ 和 $Y$ 相互独立”这一条件不能少．事实上，容易验证（读者练习.)
$$
f(x,y) = \phi (x)\phi (y)\left[1 + \frac{1}{2} (2\phi (x) - 1)(2\phi (y) - 1)\right]
$$
为一个二元概率密度函数, 且满足 $X$ 和 $Y$ 的边缘分布均为标准正态分布, 但是 $X + Y$ 的分布不是正态分布.

例 3.23 (独立随机变量商的分布) 设 $X$ 和 $Y$ 相互独立, $X\sim f_{1}(x), Y\sim f_{2}(y)$ ,求 $Z = \frac{X}{Y}$ 的分布.

解令 $U = \frac{X}{Y}, V = Y$ ,则当 $y\neq 0$ 时, 函数 $(u, v)$ 对 $(x, y)$ 的雅可比行列式的绝对值为
$$
\left|\frac{\partial(u,v)}{\partial(x,y)}\right| = \left| \begin{array}{cc}\frac{1}{y} & -\frac{x}{y^2} \\ 0 & 1 \end{array} \right| = \frac{1}{|y|},
$$
所以 $(x, y)$ 对 $(u, v)$ 的雅可比行列式的绝对值为 $|y| = |v|$ ,由此得
$$
F_{Z}(z) = \iint_{x / y\leqslant z}f_{1}(x)f_{2}(y)\mathrm{d}x\mathrm{d}y = \int_{-\infty}^{z}\mathrm{d}u\int_{-\infty}^{+\infty}|v|f_{1}(uv)f_{2}(v)\mathrm{d}v.
$$
由密度函数的定义知
$$
f_{Z}(z) = \int_{-\infty}^{+\infty}|v|f_{1}(zv)f_{2}(v)\mathrm{d}v.
$$
例如, 设 $X$ 和 $Y$ 是独立的随机变量, 均服从 $N\left (0,\sigma^{2}\right), Z = \frac{X}{Y}$ 。则
$$
\begin{array}{l}{{f_{Z}(z)=\frac{1}{2\pi\sigma^{2}}\int_{-\infty}^{\infty}|y|\exp\Big\{-\frac{\left(1+z^{2}\right)y^{2}}{2\sigma^{2}}\Big\}\mathrm{d}y}}\\ {{\quad=\frac{1}{\pi\sigma^{2}}\int_{0}^{\infty}y\exp\Big\{-\frac{\left(1+z^{2}\right)y^{2}}{2\sigma^{2}}\Big\}\mathrm{d}y}}\\ {{\quad=\frac{1}{\pi\left(1+z^{2}\right)}}.}\end{array}
$$
该分布称为柯西 (Cauchy) 分布, 即独立正态分布随机变量的商服从柯西分布。

例 3.24 设 $X$ 和 $Y$ 相互独立, $X\sim N (0,1), Y\sim N (0,1)$ ,求 $(X, Y)$ 的极坐标变换后极轴和极角 $(R,\theta)$ 的分布。

解由定义, 作极坐标变换 $X = R\cos \theta ,Y = R\sin \theta$ ,其中 $R > 0,\theta \in [0,2\pi)$ 。则 $(x, y)$ 对 $(r,\theta)$ 的雅可比行列式的绝对值为 $r$ ,由于
$$
f(x,y) = \frac{1}{2\pi}\exp \Big\{-\frac{1}{2} (x^{2} + y^{2})\Big\} ,
$$
作极坐标变换后由 (3.24) 式得
$$
f_{R,\theta}(r,\theta) = \frac{1}{2\pi}\exp \Big\{-\frac{r^{2}}{2}\Big\} rI_{(0,\infty)\times [0,2\pi)}(r,\theta).
$$
由上式知, 极坐标变换后的 $(R,\theta)$ 是相互独立的。其中 $R\sim r\exp \Big\{- \frac{x^{2}}{2}\Big\} I_{(0,\infty)}(r),\theta \sim U[0,2\pi)$ 。

例 3.25 设随机变量 $X_{1}, X_{2}, X_{3}$ 相互独立且都服从区间 $(0,1)$ 上的均匀分布。

(1) 若随机变量 $Y = -a\ln X_{1}$ ,其中 $a > 0$ 为一给定常数, 试求 $Y$ 的概率密度函数。

(2) 试求随机变量 $Z = \frac{X_{2}}{X_{1}}$ 的分布函数。

(3) 试求随机变量 $U = \frac{1}{X_{1}X_{2}X_{3}}$ 的概率密度函数。

解 (1) 对任意 $y > 0$ , 由于
$$
P(Y \leqslant y) = P(-a \ln X_1 \leqslant y) = P\left(X_1 \geqslant \mathrm{e}^{-\frac{y}{a}}\right) = 1 - \mathrm{e}^{-\frac{y}{a}},
$$
故 $Y$ 服从参数为 $\frac{1}{a}$ 的指数分布, 从而其概率密度函数为 $f_Y (y) = \frac{1}{a} \mathrm{e}^{- \frac{y}{a}} I (y > 0)$ .

(2) 当 $0 \leqslant z < 1$ 时,
$$
P(Z \leqslant z) = P\left(X_2 \leqslant z X_1\right) = \int_0^1 \int_0^{zy} \mathrm{d}x \mathrm{d}y = \frac{z}{2};
$$
而当 $z \geqslant 1$ 时,
$$
\begin{array}{l}{P(Z\leqslant z) = P\left(X_{2}\leqslant z X_{1}\right)}\\ {= \int_{0}^{\frac{1}{z}}\int_{0}^{z y}\mathrm{d}x\mathrm{d}y + \int_{\frac{1}{z}}^{1}\int_{0}^{1}\mathrm{d}x\mathrm{d}y}\\ {= 1 - \frac{1}{2z},} \end{array}
$$
故 $Z$ 的分布函数为
$$
F_Z(z) = \left\{ \begin{array}{ll} 0, & z < 0, \\ \frac{z}{2}, & 0 \leqslant z < 1, \\ 1 - \frac{1}{2z}, & z \geqslant 1. \end{array} \right.
$$
(3) 由 $V \equiv \ln U = -\sum_{i = 1}^{3} \ln X_i$ 及

(1) 可知, $V$ 为 3 个独立的服从 $Exp (1)$ 的随机变量之和, 故 $V$ 服从 $Ga (1,3)$ 分布, 即其概率密度函数为
$$
f_V(v) = \frac{1}{2} v^2 \mathrm{e}^{-v} I_{(0,\infty)}(v).
$$
再由 $U = \mathrm{e}^{V}$ 及密度函数变换公式可知, $U$ 的概率密度函数为
$$
f_U(u) = \frac{\ln^2 u}{2u^2} I_{(1,\infty)}(u).
$$
例 3.26 (最大值和最小值的分布) 设 $X$ 和 $Y$ 相互独立, $X \sim F_1 (x), Y \sim F_2 (y)$ , 求 $\max \{X, Y\}$ 和 $\min \{X, Y\}$ 的分布.

解 首先注意 $\max \{X, Y\}$ 和 $\min \{X, Y\}$ 均为随机变量. 由于 $X$ 和 $Y$ 相互独立, 故
$$
F_{\max}(z) = P(\max \{X,Y\} \leqslant z) = P(X\leqslant z,Y\leqslant z)
$$
$$
= P(X \leqslant z) P(Y \leqslant z) = F_1(z) F_2(z),
$$
$$
\begin{array}{r l} & {F_{\min}(z) = P(\min \{X,Y\} \leqslant z) = P(\{X\leqslant z\} \cup \{Y\leqslant z\})}\\ & {\qquad = 1 - P(\{X > z\} \cap \{Y > z\}) = 1 - (1 - F_{1}(z))(1 - F_{2}(z)).} \end{array}
$$
如果 $X \sim f_{1}(x), Y \sim f_{2}(y)$ , 那么
$$
f_{\max}(z) = f_{1}(z)F_{2}(z) + F_{1}(z)f_{2}(z), \tag{3.26}
$$
$$
f_{\min}(z) = f_{1}(z)(1 - F_{2}(z)) + (1 - F_{1}(z))f_{2}(z). \tag{3.27}
$$
此例可以毫无困难地推广到 $n$ 个相互独立随机变量的最大值和最小值的分布.

例 3.27 掷两颗骰子, 设 $X$ 和 $Y$ 分别表示第一和第二次掷出的点数, 求 $P (\max \{X, Y\} = 5)$ 和 $P (\min \{X, Y\} = 3)$ .

解注意到 $X$ 和 $Y$ 相互独立, 有
$$
\begin{array}{r l} & {P(\max \{X,Y\} = 5) = P(\max \{X,Y\} \leqslant 5) - P(\max \{X,Y\} \leqslant 4)}\\ & {\qquad = \left(\frac{5}{6}\right)^{2} - \left(\frac{4}{6}\right)^{2} = \frac{1}{4},}\\ & {P(\min \{X,Y\} = 3) = P(\min \{X,Y\} \geqslant 3) - P(\min \{X,Y\} \geqslant 4)}\\ & {\qquad = \left(\frac{4}{6}\right)^{2} - \left(\frac{3}{6}\right)^{2} = \frac{7}{36}.} \end{array}
$$
例 3.28 (系统可靠性研究) 设系统 $L$ 由两个独立的子系统 $L_{1}, L_{2}$ 连接而成, 连接的方式分别为 (1) 串联, (2) 并联, (3) 备用, 如图 3.9. 设 $L_{1}, L_{2}$ 的寿命分别为 $X, Y$ ,其密度函数分别为
$$
\begin{array}{r l} & {f_{1}(x) = \alpha \mathrm{e}^{-\alpha x}I_{(0,\infty)}(x),\quad \alpha >0,}\\ & {f_{2}(y) = \beta \mathrm{e}^{-\beta y}I_{(0,\infty)}(y),\quad \beta >0.} \end{array}
$$
其中 $\alpha \neq \beta$ .求系统 $L$ 的寿命 $Z$ 的分布

![](images/63e55572e09ec9aadb6c170a89f45f8a8dd57dd6b7e647c1db391f546e036725.jpg)

图 3.9 系统连接方式

解 (1) 串联, 只要 $L_{1}, L_{2}$ 中有一个损坏, 系统 $L$ 停止工作, 故 $Z = \min \{X, Y\}$ ,由 (3.27) 式得
$$
\begin{array}{r l} & {f_{\min}(z) = (\alpha \mathrm{e}^{-\alpha z}\mathrm{e}^{-\beta z} + \beta \mathrm{e}^{-\beta z}\mathrm{e}^{-\alpha z})I_{(0,\infty)}(z)}\\ & {\qquad = (\alpha +\beta)\mathrm{e}^{-(\alpha +\beta)z}I_{(0,\infty)}(z).} \end{array}
$$
(2) 并联, 只有 $L_{1}, L_{2}$ 两个都损坏时, 系统 $L$ 才停止工作, 故 $Z = \max \{X, Y\}$ ,由 (3.26) 式得
$$
\begin{array}{r l} & {f_{\max}(z) = [\alpha \mathrm{e}^{-\alpha z}(1 - \mathrm{e}^{-\beta z}) + \beta \mathrm{e}^{-\beta z}(1 - \mathrm{e}^{-\alpha z})]I_{(0,\infty)}(z)}\\ & {\qquad = [\alpha \mathrm{e}^{-\alpha z} + \beta \mathrm{e}^{-\beta z} - (\alpha +\beta)\mathrm{e}^{-(\alpha +\beta)z}]I_{(0,\infty)}(z).} \end{array}
$$
(3) 备用, 系统 $L_{1}$ 和 $L_{2}$ 寿命之和. 即 $Z = X + Y$ ,故 $z > 0$ 时, 由独立随机变量密度函

数卷积公式，
$$
f_{X + Y}(z) = \int_{0}^{z}\alpha \mathrm{e}^{-\alpha (z - y)}\beta \mathrm{e}^{-\beta y}\mathrm{d}y = \frac{\alpha\beta}{\beta - \alpha} (\mathrm{e}^{-\alpha z} - \mathrm{e}^{-\beta z}),
$$
若 $\alpha = \beta$ ，容易得到
$$
f_{X + Y}(z) = \alpha^{2}z\mathrm{e}^{-\alpha z}I_{(0,\infty)}(z).
$$
## 扩展阅读：辛普森情论

有人说统计会撒谎. “世界上有三种谎言, 即谎言、弥天大谎和统计 (There are three kinds of lies: lies, damned lies and statistics)”. 美国作家马克·吐温 (Mark Twain, 1835—1910) 在其作品《我的自传》中的曾引用此话. 将统计和谎言相提并论显然有失公允. 如今人们理解这句话, 大多指向的是对统计数据的人为操纵和恶意利用. 其实, 数字本身不会说谎, 数字只是一个信息载体, 说谎的其实是使用数字的人. 数字既可以拿来解释客观世界, 也可以用来曲解事实真相. 这也恰好说明, 如果没有一定的统计学知识, 人们就有可能从接收到的信息里得出错误的结论. 美国统计学家哈夫 (Darrell Huff, 1913—2001) 还为此出版了一本名为《统计数字会撒谎》(How to Lie with Statistics) 的科普读本. 该书用大量生动有趣的实例, 揭露了当时美国社会中一些利用数字和数据造假的现象, 引起了极大反响. 书中提出的统计陷阱的例子, 比如样本选择偏差、平均数的选择以及相关性的滥用等, 在现今的生活中仍然十分常见. 该书自 1954 年出版至今, 多次重印, 被译为多种文字, 影响深远, 光在国内出版的中译名就有《统计陷阱》《统计数字会撒谎》《怎能利用统计撒谎》和《别让统计数字骗了你》等. 在日常的经济生活中, 我们将接触到越来越多的统计数据和资料, 例如各种证券信息、投资可行性研究报告、公司财务报告等, 这些资料和数据如何去伪存真, 如何进行鉴别? 没有很好的统计思维, 就很有可能陷入那些精心炮制的数据陷阱之中, 从而得出有失偏颇的结论.

下面我们将通过统计学里一个有名的辛普森情论来说明统计是如何“撒谎”的.

### 什么是辛普森情论

当人们尝试探究两种变量是否具有相关性的时候, 比如新生录取率与性别, 报酬与性别等, 会分别对之进行分组研究. 辛普森悖论是在这种研究中, 在某些前提下有时会产生的一种现象, 即在分组比较中都占优势的一方, 在总评中反而会是失势的一方. 该现象于 20 世纪初就有人讨论, 但一直到 1951 年英国统计学家辛普森 (Edward H. Simpson, 1922— ) 在他发表的论文中该现象才算正式被描述和解释. 后来就以他的名字命名该悖论.

我们通过一个虚构的简单例子来说明什么是辛普森悖论. 一所高校的两个学院, 分别是法学院和商学院. 人们怀疑这两个学院在新生招生中有性别歧视.

如表 3.1 所示, 无论在法学院还是在商学院, 女生的录取比例都高于男生, 由此可以推断

学校在招生时更倾向于招女生吗？但是，如果将两个学院的数据汇总，结果如表 3.2 所示，却发现女生的总体录取率实际上比男生要低.

表 3.1 各学院录取率

<table><tr><td></td><td>法学院男生</td><td>法学院女生</td><td>商学院男生</td><td>商学院女生</td></tr><tr><td>录取人数</td><td>8</td><td>51</td><td>201</td><td>92</td></tr><tr><td>未录取人数</td><td>45</td><td>101</td><td>50</td><td>9</td></tr><tr><td>录取率/%</td><td>15.1</td><td>33.6</td><td>80.1</td><td>91.1</td></tr></table>

表 3.2 总体录取率

<table><tr><td></td><td>男生</td><td>女生</td></tr><tr><td>录取人数</td><td>209</td><td>143</td></tr><tr><td>未录取人数</td><td>95</td><td>110</td></tr><tr><td>录取率/%</td><td>68.8</td><td>56.5</td></tr></table>

上面的例子说明简单地将分组数据相加汇总有时并不能反映真实的整体情况．这种看起来“自相矛盾”的情况是怎么发生的呢？就这个例子来说，导致辛普森论发生一般有两个前提.

第一，两个分组的录取率相差很大，即法学院录取率很低，而商学院却很高．另一方面，两种性别的申请者分布比率相反，即法学院大部分申请者为女性，而商学院大部分申请者为男性．结果在数量上来说，拒收率高的法学院拒收了很多的女生，男生虽然有更高的拒收率，但被拒收的数量却相对不算多．而录取率很高的商学院虽然有较高的录取比例，但是被拒收的男生数量相对法学院来说则明显较多.

第二，有潜在因素影响着录取情况，即性别并非是影响录取率高低的唯一因素，甚至可能是毫无影响的．至于在学院中出现的比率差，可能只是随机因素造成的，又或者是其他因素作用 (如入学成绩). 刚好出现这种录取比例，使人牵强地误认为这是由性别差异而造成的.

辛普森论也可以从数学上解释，即若有
$$
\frac{a_{1}}{b_{1}} >\frac{a_{2}}{b_{2}},\quad \frac{c_{1}}{d_{1}} >\frac{c_{2}}{d_{2}},
$$
但并不能保证
$$
\frac{a_{1} + c_{1}}{b_{1} + d_{1}} >\frac{a_{2} + c_{2}}{b_{2} + d_{2}}.
$$
这个结论很初等，我们相信很多同学能给出适当的例子以验证，只是对很多人来说比较“反常识”而已.

辛普森论的重要性在于它揭示了：我们看到的数据并非全貌．我们不能满足于展示的数字或图表，需要考虑整个数据生成过程，将所有可能的因素或变量考虑进来以通过它们的联合分布来研究．一种更深刻的解释是统计学中的因果推断．一旦我们理解了数据产生的机制，

我们就能从图表之外的角度来考虑问题, 找到其他影响因素. 如果两个统计变量 $X$ 与 $Y$ 之间存在因果关系, 那么这种因果关系存在三个可能, 要么是 $X$ 导致 $Y$ , 要么是 $Y$ 导致 $X$ , 或者存在一个共同的原因 $Z$ , 同时导致了 $X$ 与 $Y$ .

## 本章总结

![](images/2d0456ef70621d4fc930f843df88da9498bdc1b116e8e2a48f32cc2cdf2dd4b9.jpg)

图 3.10 第三章知识点结构图

### 重点概念总结

取有限个值的二维离散型随机变量的分布律一般用矩形表格来表示, 由此可以方便获得边缘分布和条件分布.

如果 $(X, Y)$ 服从二元正态分布, 那么唯一确定的两个边缘分布都是正态分布, 反之, 边缘分布不能唯一确定联合分布.

计算有关事件概率的难点是计算二重积分, 计算二维随机变量的函数分布的关键之一是二重积分中的变量代换.

为了求出 $g (X, Y)$ 的密度函数, 可以令 $U = g (x, y), V = h (x, y)$ , 先求出 $U (X, Y), V (X, Y)$ 的联合密度函数, 然后对其中一个变量积分获得另一个变量的密度函数.

利用条件密度函数、边缘密度函数和联合密度函数三者之间的关系计算联合密度函数或边缘密度函数.

两个随机变量相互独立是指: 任取与 $X$ 有关的事件 $A$ 以及与 $Y$ 有关的事件 $B$ , 则事件 $A, B$ 相互独立, 由此来理解随机变量独立的定义以及计算有关的概率.

## 习题

1. 箱中装有 6 个球, 其中红、白、黑球的个数分别为 1,2,3. 现从箱中随机地取出 2 个球, 记 $X$ 为取出的红球个数, $Y$ 为取出的白球个数. 求随机变量 $(X, Y)$ 的联合分布函数.

2. 袋中有一个红球, 两个黑球, 三个白球, 现有放回地从袋中取两次, 每次取一球, 以 $X, Y$ , $Z$ 分别表示两次取球的红、黑、白球的个数.

(1) 求 $P (X = 1|Z = 0)$ ;

(2) 求二维随机变量 $(X, Y)$ 的联合分布函数.

3. 将同一硬币连续掷三次, 以 $X$ 表示在三次中出现正面的次数, 以 $Y$ 表示三次中出现的正面次数和出现的反面次数之差的绝对值. 试写出 $X$ 和 $Y$ 的联合分布律.

4. 现有某种产品 100 个, 其中一、二、三等品分别为 80,10,10 个, 现从中随机抽取一个产品, 记
$$
X_{1}=\left\{\begin{array}{l l}{{1,}}&{{\hbar\mathbb{H}\mathbb{H}\mathbb{H}\mathbb{H}\mathbb{H},}}\\ {{0,}}&{{\mathbb{H}\mathbb{H},}}\end{array}\right.\qquad X_{2}=\left\{\begin{array}{l l}{{1,}}&{{\hbar\mathbb{H}\mathbb{H}\mathbb{H}\mathbb{H},}}\\ {{0,}}&{{\mathbb{H}\mathbb{H},}}\end{array}\right.
$$
求 $(X_{1}, X_{2})$ 的联合分布律

5. 设二维随机向量的联合分布律为

<table><tr><td rowspan="2">Y</td><td colspan="2">X</td></tr><tr><td>-1</td><td>1</td></tr><tr><td>-1</td><td>0.2</td><td>b</td></tr><tr><td>1</td><td>a</td><td>0.3</td></tr></table>

已知事件 $\{X = - 1\}$ 和 $\{X + Y = 0\}$ 相互独立, 求 $a, b$

6. 设某射手每次射中目标的概率为 $p (0< p< 1)$ , 射击进行到第二次射中目标为止, $X$ 表示第一次射中目标所进行的射击次数, $Y$ 表示第二次射中目标所进行的射击次数.

(1) 求二维随机变量 $(X, Y)$ 的联合分布律;

(2) 求 $X$ 和 $Y$ 的边缘分布.

7. 从 1,2,3,4 四个数中任取一个数, 记为 $X$ , 再从 1 到 $X$ 中任取一个数, 记为 $Y$ , 求事件 $\{Y = 2\}$ 发生的概率.

8. 设二维随机变量 $(X, Y)$ 服从正态分布 $N (1,0,1,1,0)$ , 求 $P (XY - Y< 0)$ .

9. 设二维随机变量 $(X, Y)$ 的联合分布函数为
$$
F(x,y) = a(b + \arctan x)(c + \arctan y), \quad x,y \in \mathbb{R}.
$$
(1) 确定常数 $a, b, c$

(2) 求 $P (X > 0, Y > 0)$ ;

(3) 求 $X$ 和 $Y$ 的边缘密度函数.

10. 设二维随机变量 $(X, Y)$ 的密度函数为
$$
f(x,y) = \left\{ \begin{array}{cl}\cos x\cos y, & 0< x< \pi /2,0< y< \pi /2,\\ 0, & \text{其他}. \end{array} \right.
$$
(1) 试求 $(X, Y)$ 的分布函数;

(2) 试求概率 $P (0< X< \pi /4,\pi /4< Y< \pi /2)$

11. 设二维随机变量 $(X, Y)$ 的密度函数为
$$
f(x,y) = \left\{ \begin{array}{cl}\mathrm{e}^{-x}, & 0< y< x,\\ 0, & \text{其他}. \end{array} \right.
$$
(1) 求条件密度函数 $f_{Y\mid X}(y|x)$

(2) 求条件概率 $P (X\leqslant 1|Y\leqslant 1)$

12. 设二维随机变量 $(X, Y)$ 的密度函数为
$$
f(x,y) = A\mathrm{e}^{-2x^2 +2xy - y^2},\quad (x,y)\in \mathbb{R}^2.
$$
求常数 $A$ 及条件密度函数 $f_{Y\mid X}(y|x)$

13. 设二维随机变量 $(X, Y)$ 的密度函数为
$$
f(x,y) = \left\{ \begin{array}{cl}A x^2, & 0< |x|< y< 1,\\ 0, & \text{其他}. \end{array} \right.
$$
求常数 $A$ 及条件概率 $P (X\leqslant 0.25|Y = 0.5)$

14. 设随机变量 $X$ 与 $Y$ 相互独立, 且 $X$ 服从标准正态分布 $N (0,1)$ , $Y$ 的分布律为 $P (Y = 0) = P (Y = 1) = \frac{1}{2}$ , 求随机变量 $Z = XY$ 的分布函数.

15. 设 $X$ 和 $Y$ 是相互独立的随机变量, $X\sim N (0,\sigma_1^2)$ , $Y\sim N (0,\sigma_2^2)$ , 其中 $\sigma_1,\sigma_2 > 0$ 为常数. 引入随机变量
$$
Z = \left\{ \begin{array}{ll}1, & X\leqslant Y,\\ 0, & X > Y. \end{array} \right.
$$
求 $Z$ 的分布律.

16. 设二维随机变量 $(X, Y)$ 的密度函数为
$$
f(x,y) = \left\{ \begin{array}{cl}c(R - \sqrt{x^2 + y^2}), & x^2 +y^2 < R^2,\\ 0, & x^2 +y^2\geqslant R^2. \end{array} \right.
$$
(1) 求 $\bar{c}$ 的值;

(2) 求 $(X, Y)$ 落在圆 $\{(x, y):x^{2} + y^{2}\leqslant r^{2}\} (r< R)$ 内的概率.

17. 设 $(X, Y)$ 是二维随机变量, $X$ 的边缘密度函数为
$$
f_{X}(x) = \left\{ \begin{array}{ll}3x^{2}, & 0< x< 1, \\ 0, & \text{其他}, \end{array} \right.
$$
在给定 $X = x (0< x< 1)$ 的条件下, $Y$ 的条件密度函数为
$$
f_{Y|X}(y|x) = \left\{ \begin{array}{ll} \frac{3y^{2}}{x^{3}}, & 0< y< x, \\ 0, & \text{其他}. \end{array} \right.
$$
(1) 求 $(X, Y)$ 的联合密度函数 $f (x, y)$

(2) 求 $Y$ 的边缘密度函数 $f_{Y}(y)$

18. 设随机变量 $X$ 的密度函数为 $f_{X}(x) = x\mathrm{e}^{-x}I_{(0,\infty)}(x)$ , 而随机变量 $Y$ 服从 $(0, X)$ 上的均匀分布, 求

(1) $(X, Y)$ 的联合分布函数;

(2) 随机变量 $Y$ 的分布函数.

19. 设在 $X = x$ 的条件下, $Y$ 服从参数为 $x$ 的泊松分布, 已知 $X$ 服从参数为 1 的指数分布, 求 $Y$ 的分布律.

20. 设 $(X, Y)$ 是矩形 $\{(x, y): 0\leqslant x\leqslant 2,0\leqslant y\leqslant 2\}$ 上的均匀分布, 求随机变量 $Z = |X - Y|$ 的密度函数.

21. 设 $(X, Y)$ 在区域 $G$ 上服从均匀分布, $G$ 由 $x - y = 0, x + y = 2$ 与 $y = 0$ 围成. 试求

(1) 边缘密度函数 $f_{X}(x)$

(2) 条件密度函数 $f_{X|Y}(x|y)$

22. 设随机向量 $(X, Y)$ 服从区域 $D$ 内的均匀分布, 其中 $D$ 是由直线 $y = x, x = 0, y = 1$ 所围成的区域, 试求

(1) $(X, Y)$ 的联合密度函数 $f (x, y)$

(2) $(X, Y)$ 的边缘密度函数 $f_{1}(x)$ 和 $f_{2}(y)$

(3) 条件密度函数 $f_{X|Y}(x|y)$

(4) $P (X\leqslant 0.5|Y = y)$

23. 设 $(X, Y)$ 服从矩形 $\{(x, y): 0\leqslant x\leqslant 2,0\leqslant y\leqslant 1\}$ 内的均匀分布, 记
$$
U=\left\{\begin{array}{l l}{0,}&{X\leqslant Y,}\\ {1,}&{X>Y,}\end{array}\right.\qquad V=\left\{\begin{array}{l l}{0,}&{X\leqslant2Y,}\\ {1,}&{X>2Y,}\end{array}\right.
$$
求 $(U, V)$ 的联合分布函数.

24. 从一副扑克牌 (共 52 张) 中任取 13 张, 以 $X$ 和 $Y$ 分别记其中的黑桃和红桃张数. 试求:

(1) $(X, Y)$ 的联合概率质量函数;

(2) 已知取出的只有一张黑桃, 求此时 $Y$ 的条件概率分布.

25. 假设有 $n$ $(n\geqslant 3)$ 个不同的盒子与 $m$ 个相同的小球，每个小球独立地以概率 $p_k$ 落入第 $k$ 个盒子 $(k = 1,2,\dots ,n)$ .分别以 $X_{1}, X_{2},\dots ,X_{n}$ 表示落入各个盒子的球数. 试求

(1) $(X_{1}, X_{2},\dots ,X_{n})$ 的联合分布函数；(2) $X_{k}$ 的边缘分布函数，其中 $k = 1,2,\dots ,n$

(3) $(X_{1}, X_{2})$ 的边缘分布函数；(4) 在 $X_{1} = m_{1}$ 的条件下， $(X_{2}, X_{3},\dots ,X_{n})$ 的条件分布函数.

26. 设随机变量 $X$ 与 $Y$ 相互独立， $X$ 的概率分布为
$$
P(X = i) = \frac{1}{3},\quad i = -1,0,1,
$$
$Y$ 的密度函数为 $f_{Y}(y) = \left\{ \begin{array}{ll}1, & 0\leqslant y\leqslant 1,\\ 0, & \text{其他}, \end{array} \right.$ 记 $Z = X + Y.$

(1) 求 $P\left (Z\leqslant \frac{1}{2} |X = 0\right)$

(2) 求 $Z$ 的密度函数.

29, 34, 35, 40, 43

27. 设随机变量 $X$ 与 $Y$ 相互独立， $X$ 服从参数为 1 的指数分布， $Y$ 服从标准正态分布，求 $(X,|Y|)$ 的联合密度函数.

28. 设某班车起点站上客人数 $X$ 服从参数为 $\lambda (\lambda >0)$ 的泊松分布，每位乘客在中途下车的概率为 $p$ $(0< p< 1)$ ，且中途下车与否相互独立，以 $Y$ 表示中途下车的人数，求

(1) 在发车时，有 $n$ 个乘客的条件下，中途有 $m$ 个人下车的概率；(2) 二维随机变量 $(X, Y)$ 的概率分布.

29. 设 $X\sim N (\mu ,\sigma^2)$ $Y\sim B (1, p)$ ，且随机变量 $X, Y$ 相互独立. 求 $XY$ 的分布.

30. 设 $X, Y$ 是两个相互独立的随机变量， $X$ 在 $(0,1)$ 上服从均匀分布， $Y$ 的密度函数为
$$
f_{Y}(y) = \left\{ \begin{array}{ll}\frac{1}{2}\mathrm{e}^{-y / 2}, & y > 0,\\ \displaystyle 0, & y\leqslant 0. \end{array} \right.
$$
(1) 求 $(X, Y)$ 的联合密度函数；(2) 求二次方程 $a^2 +2Xa + Y = 0$ 有实根的概率.

31. 设 $(X, Y, Z)$ 服从单位球 $\{(x, y, z):x^{2} + y^{2} + z^{2}\leqslant 1\}$ 内的均匀分布，试求 $X$ 的边缘分布.

32. 设随机变量 $X, Y$ 的分布律分别为

<table><tr><td>X</td><td>0</td><td>1</td></tr><tr><td>P</td><td>1/2</td><td>1/2</td></tr></table>

<table><tr><td>Y</td><td>-1</td><td>0</td><td>1</td></tr><tr><td>P</td><td>1/4</td><td>1/2</td><td>1/4</td></tr></table>

且 $P (XY = 0) = 1$

(1) 求 $(X, Y)$ 的联合分布；(2) 问 $X, Y$ 是否独立.

33. 连续地掷一颗均匀的骰子，直到出现点数大于 2 为止，以 $X$ 表示掷骰子的次数，以 $Y$ 表示最后一次掷出的点数.

(1) 求二维随机变量 $(X, Y)$ 的联合分布以及 $X, Y$ 的边缘分布；(2) 问 $X$ 和 $Y$ 是否相互独立.

34. 令 $X$ 和 $Y$ 为独立的离散型随机变量，且在 $\{0,1,\dots ,K - 1\}$ 上均匀分布，考虑
$$
Z_{n}\equiv X + nY(\mathrm{mod} K),
$$
研究 $Z_{n}$ 的独立性和两两独立性

35. 设 $(X, Y)$ 的联合密度函数为
$$
f(x,y) = \left\{ \begin{array}{c c}{A\mathrm{e}^{-(3x + 4y)},} & {x > 0,y > 0,}\\ {0,} & {\mathbb{H}\backslash \mathbb{H}.} \end{array} \right.
$$
(1) 求系数 $A$

(2) $X$ 与 $Y$ 是否独立；(3) 求 $Z = X + Y$ 的密度函数 $f_{Z}(z)$

(4) 试求 $P (X > 0.5|X + Y = 1)$

36. 设随机向量 $(X, Y)$ 服从 $\{(x, y):|x + y|\leqslant 1,|x - y|\leqslant 1\}$ 内的均匀分布，

(1) 试求出 $X$ 和 $Y$ 的边缘分布；(2) $X$ 和 $Y$ 是否相互独立？(3) 求在 $X = x$ $(0< x< 1)$ 时， $Y$ 的条件密度函数.

37. 设 $(X, Y)$ 的联合密度函数为
$$
f(x,y) = \left\{ \begin{array}{c c}{0.25(1 + x y),} & {|x|< 1, |y|< 1,}\\ {0,} & {\mathbb{H}\backslash \mathbb{H}.} \end{array} \right.
$$
(1) 求给定 $X = \frac{1}{2}$ 时， $Y$ 的条件密度函数；(2) 证明 $X^{2}$ 和 $Y^{2}$ 相互独立.

88. 设随机变量 $X, Y$ 的分布律分别为

<table><tr><td>X</td><td>0</td><td>1</td></tr><tr><td>P</td><td>1/3</td><td>2/3</td></tr></table>

<table><tr><td>Y</td><td>-1</td><td>0</td><td>1</td></tr><tr><td>P</td><td>1/3</td><td>1/3</td><td>1/3</td></tr></table>

且 $P (X^{2} = Y^{2}) = 1$ .求

(1) $(X, Y)$ 的联合分布；(2) $Z = X Y$ 的概率分布.

39. 设 $(X, Y)$ 服从正方形 $\{(x, y):|x| + |y|\leqslant 1\}$ 内的均匀分布，

(1) 求 $X$ 与 $Y$ 的边缘分布；(2) 问 $X, Y$ 是否相互独立？

40. 设随机向量 $(X, Y)$ 的密度函数为
$$
f(x,y) = \left\{ \begin{array}{ll}3x, & 0< x< 1,0< y< z,\\ 0, & \text{其他}. \end{array} \right.
$$
(1) 求 $X$ 与 $Y$ 的边缘密度函数；(2) 问 $X$ 与 $Y$ 是否相互独立？(3) 计算 $P (X + Y\leqslant 1)$

41. 设 $(X, Y)$ 的联合分布函数为
$$
F(x,y) = \left\{ \begin{array}{ll}\frac{[1 - (x + 1)\mathrm{e}^{-x}]y}{1 + y}, & x > 0,y > 0,\\ 0, & \text{其他}. \end{array} \right.
$$
(1) 求 $X, Y$ 的边缘分布函数 $F_{X}(x)$ 和 $F_{Y}(y)$

(2) 求 $(X, Y)$ 的联合密度函数 $f (x, y)$ 以及边缘密度函数 $f_{X}(x), f_{Y}(y)$

(3) 验证 $X, Y$ 是否相互独立.

42. 设随机向量 $(X, Y, Z)$ 的联合密度函数为
$$
f(x,y,z) = \left\{ \begin{array}{ll}(8\pi^{3})^{-1}(1 - \sin x\sin y\sin z), & 0\leqslant x,y,z\leqslant 2\pi ,\\ 0, & \text{其他}. \end{array} \right.
$$
证明： $X, Y, Z$ 两两独立但不相互独立

43. 设随机向量 $(X, Y)$ 的密度函数为
$$
f(x,y) = \left\{ \begin{array}{ll}\frac{1 + xy}{4}, & |x|< 1,|y|< 1,\\ 0, & \text{其他}. \end{array} \right.
$$
证明： $X, Y$ 不独立但是 $X^{2}, Y^{2}$ 是相互独立的

44. 设连续型随机变量 $X\sim f (x), Y$ 为取有限值的离散型随机变量，且 $X, Y$ 相互独立.

(1) 求 $Z = X + Y$ 的分布. 由此回答随机变量 $Z$ 是否为连续型的？(2) 求 $W = XY$ 的分布，问 $W$ 是不是连续型随机变量？以 $X\sim N (\mu ,\sigma^2), Y\sim B (1, p)$ 为例求出 $W$ 具体的分布.

45. 在长度为 1 的线段上任取两点，把线段分为 3 段，求这 3 条线段能组成三角形的概率.

46. * 设随机变量 $X$ 的密度函数为 $f (x)$ , 令
$$
Y = \left\{ \begin{array}{ll}a, & X < a, \\ X, & a \leqslant X < b, \\ b, & X \geqslant b. \end{array} \right.
$$
(1) 求随机变量 $Y$ 的分布函数;

(2) 随机变量 $Y$ 的分布有什么特点?

47. * 设 $(X, Y) \sim N (\mu_1,\mu_2,\sigma_1^2,\sigma_2^2,\rho)$ , 证明: 存在常数 $b$ , 使 $X + bY, X - bY$ 相互独立.

48. * 设 $(X, Y) \sim N (0,0,1,1,\rho)$ , 证明

(1) 随机变量 $X$ 与随机变量 $Z = \frac{Y - \rho X}{\sqrt{1 - \rho^2}}$ 相互独立;

(2) 利用 (1) 的结论证明
$$
P(XY< 0) = 1 - 2P(X > 0,Y > 0) = \pi^{-1}\arccos \rho . \tag{3.28}
$$
49. * (多项分布) 设 $A_{1}, A_{2},\dots ,A_{n}$ 是样本空间上的一个完备事件群, 即 $A_{i}A_{j} = \phi ,i\neq j$ , 其和为必然事件, 记 $P (A_{i}) = p_{i} > 0, i = 1,2,\dots ,n$ , 则 $p_1 + p_2 + \dots +p_n = 1$ . 由上面知, 在一次试验中, 事件 $A_{1}, A_{2},\dots ,A_{n}$ 必然发生一个且仅发生一个. 现在把该试验独立重复 $N$ 次, 以 $X_{i}$ 记事件 $A_{i}$ 出现的次数, $i = 1,2,\dots ,n$ , 则称 $(X_{1}, X_{2},\dots ,X_{n})$ 服从多项分布, 记为
$$
(X_{1},X_{2},\dots ,X_{n})\sim M(N,p_{1},p_{2},\dots ,p_{n}),
$$
其中 $X_{1} + X_{2} + \dots +X_{n} = N$ , 证明:

(1) $(X_{i}, X_{j}, Z)$ 在给定 $X_{l} = N_{l}$ 的条件下服从三项分布 $M\Big (N - N_{l},\frac{p_{i}}{1 - p_{l}},\frac{p_{j}}{1 - p_{l}}, 1 - \frac{p_{i} + p_{j}}{1 - p_{l}}\Big)$ , 其中 $1\leqslant i\neq j\neq l\leqslant n$ , $Z = N - N_{l} - X_{i} - X_{j}$ ;

(2) 设 $1\leqslant j< n$ , 则
$$
(X_{1} + X_{2} + \dots +X_{j})\sim B(N,p_{1} + p_{2} + \dots +p_{j}).
$$
